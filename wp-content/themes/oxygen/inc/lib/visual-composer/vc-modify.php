<?php
/**
 *	This will add better support for Visual Composer in Oxygen Theme
 *	
 *	Laborator.co
 *	www.laborator.co 
 */


$lvcm_min_version = '4.2.0';
$lvcm_max_version = '4.2.9';

$plugin_dir = 'js_composer';

$files = array(
	'include/classes/core/class-wpb-map.php' => 'PD9waHANCi8qKg0KICogV1BCYWtlcnkgVmlzdWFsIENvbXBvc2VyIE1haW4gbWFuYWdlci4NCiAqDQogKiBAcGFja2FnZSBXUEJha2VyeVZpc3VhbENvbXBvc2VyDQogKiBAc2luY2UgICA0LjINCiAqLw0KLyoqDQogKiBWYyBtYXBwZXIgbmV3IGNsYXNzLg0KICoNCiAqIFRoaXMgY2xhc3MgbWFwcyBzaG9ydGNvZGVzIHNldHRpbmdzIHRvIFZDIGVkaXRvcnMuIFlvdSBjYW4gbWFuYWdlIGFkZCBuZXcgc2hvcnRjb2RlcyBvciBtYW5hZ2UgZGVmYXVsdCBzaG9ydGNvZGVzDQogKiBtYXBwZWQgaW4gY29uZmlnL21hcC5waHAuIEZvciBkZXZlbG9wZXJzIGl0IGlzIHBvc3NpYmxlIHRvIHVzZSBBUEkgZnVuY3Rpb25zIHRvIGFkZCB1cGRhdGUgc2V0dGluZ3MgYXR0cmlidXRlcy4NCiAqDQogKiBAc2VlIGNvbmZpZy9tYXAucGhwDQogKiBAc2VlIGluY2x1ZGUvaGVscGVycy9oZWxwZXJzX2FwaS5waHANCiAqIEBzaW5jZSAzLjENCiAqDQogKi8NCmNsYXNzIFdQQk1hcCB7DQoJcHJvdGVjdGVkIHN0YXRpYyAkc2MgPSBBcnJheSgpOw0KCXByb3RlY3RlZCBzdGF0aWMgJGNhdGVnb3JpZXMgPSBBcnJheSgpOw0KCXByb3RlY3RlZCBzdGF0aWMgJHVzZXJfc2MgPSBmYWxzZTsNCglwcm90ZWN0ZWQgc3RhdGljICR1c2VyX3NvcnRlZF9zYyA9IGZhbHNlOw0KCXByb3RlY3RlZCBzdGF0aWMgJHVzZXJfY2F0ZWdvcmllcyA9IGZhbHNlOw0KCXByb3RlY3RlZCBzdGF0aWMgJHNldHRpbmdzLCAkdXNlcl9yb2xlOw0KCXByb3RlY3RlZCBzdGF0aWMgJHRhZ3NfcmVnZXhwOw0KCXByb3RlY3RlZCBzdGF0aWMgJGlzX2luaXQgPSBmYWxzZTsNCg0KCS8qKg0KCSAqIFNldCBpbml0IHN0YXR1cyBmcm8gV1BNYXAuDQoJICoNCgkgKiBpZiAkaXNfaW5pdCBpcyBGQUxTRSwgdGhlbiBhbGwgYWN0aXZpdHkgbGlrZSBhZGQsIHVwZGF0ZSBhbmQgZGVsZXRlIGZvciBzaG9ydGNvZGVzIGF0dHJpYnV0ZXMgd2lsbCBiZSBob2xkIGluDQoJICogdGhlIGxpc3Qgb2YgYWN0aXZpdHkgYW5kIHdpbGwgYmUgZXhlY3V0ZWQgYWZ0ZXIgaW5pdGlhbGl6YXRpb24uDQoJICoNCgkgKiBAc2VlIFZjX01hcHBlcjo6aW5peS4NCgkgKiBAc3RhdGljDQoJICogQHBhcmFtIGJvb2wgJHZhbHVlDQoJICovDQoJcHVibGljIHN0YXRpYyBmdW5jdGlvbiBzZXRJbml0KCAkdmFsdWUgPSB0cnVlICkgew0KCQlzZWxmOjokaXNfaW5pdCA9ICR2YWx1ZTsNCgl9DQoNCgkvKioNCgkgKiBHZXRzIHVzZXIgcm9sZSBhbmQgYWNjZXNzIHJ1bGVzIGZvciBjdXJyZW50IHVzZXIuDQoJICoNCgkgKiBAc3RhdGljDQoJICogQHJldHVybiBtaXhlZA0KCSAqLw0KCXByb3RlY3RlZCBzdGF0aWMgZnVuY3Rpb24gZ2V0U2V0dGluZ3MoKSB7DQoJCWdsb2JhbCAkY3VycmVudF91c2VyOw0KDQoJCWlmICggc2VsZjo6JHNldHRpbmdzID09PSBudWxsICkgew0KCQkJaWYgKCBmdW5jdGlvbl9leGlzdHMoICdnZXRfY3VycmVudHVzZXJpbmZvJyApICkgew0KCQkJCWdldF9jdXJyZW50dXNlcmluZm8oKTsNCgkJCQkvKiogQHZhciAkc2V0dGluZ3MgLSBnZXQgdXNlIGdyb3VwIGFjY2VzcyBydWxlcyAqLw0KCQkJCWlmICggISBlbXB0eSggJGN1cnJlbnRfdXNlci0+cm9sZXMgKSApDQoJCQkJCXNlbGY6OiR1c2VyX3JvbGUgPSAkY3VycmVudF91c2VyLT5yb2xlc1swXTsNCgkJCQllbHNlDQoJCQkJCXNlbGY6OiR1c2VyX3JvbGUgPSAnYXV0aG9yJzsNCgkJCX0gZWxzZSB7DQoJCQkJc2VsZjo6JHVzZXJfcm9sZSA9ICdhdXRob3InOw0KCQkJfQ0KCQkJc2VsZjo6JHNldHRpbmdzID0gdmNfc2V0dGluZ3MoKS0+Z2V0KCAnZ3JvdXBzX2FjY2Vzc19ydWxlcycgKTsNCgkJfQ0KDQoJCXJldHVybiBzZWxmOjokc2V0dGluZ3M7DQoJfQ0KDQoJLyoqDQoJICogQ2hlY2sgaXMgc2hvcnRjb2RlIHdpdGggYSB0YWcgbWFwcGVkIHRvIFZDLg0KCSAqDQoJICogQHN0YXRpYw0KCSAqIEBwYXJhbSAkdGFnIC0gc2hvcnRjb2RlIHRhZy4NCgkgKiBAcmV0dXJuIGJvb2wNCgkgKi8NCglwdWJsaWMgc3RhdGljIGZ1bmN0aW9uIGV4aXN0cyggJHRhZyApIHsNCgkJcmV0dXJuIChib29sZWFuKWlzc2V0KCBzZWxmOjokc2NbJHRhZ10gKTsNCgl9DQoNCgkvKioNCgkgKiBNYXAgc2hvcnRjb2RlIHRvIFZDLg0KCSAqDQoJICogVGhpcyBtZXRob2QgbWFwcyBzaG9ydGNvZGUgdG8gVkMuDQoJICogWW91IG5lZWQgdG8gc2hvcnRjb2RlJ3MgdGFnIGFuZCAgc2V0dGluZ3MgdG8gbWFwIGNvcnJlY3RseS4NCgkgKiBEZWZhdWx0IHNob3J0Y29kZXMgYXJlIG1hcHBlZCBpbiBjb25maWcvbWFwLnBocCBmaWxlLg0KCSAqIFRoZSBiZXN0IHdheSBpcyB0byBjYWxsIHRoaXMgbWV0aG9kIHdpdGggImluaXQiIGFjdGlvbiBjYWxsYmFjayBmdW5jdGlvbiBvZiBXUC4NCgkgKg0KCSAqIEBzdGF0aWMNCgkgKiBAcGFyYW0gJHRhZw0KCSAqIEBwYXJhbSAkYXR0cmlidXRlcw0KCSAqIEByZXR1cm4gYm9vbA0KCSAqLw0KCXB1YmxpYyBzdGF0aWMgZnVuY3Rpb24gbWFwKCAkdGFnLCAkYXR0cmlidXRlcyApIHsNCgkJaWYgKCAhIHNlbGY6OiRpc19pbml0ICkgew0KCQkJdmNfbWFwcGVyKCktPmFkZEFjdGl2aXR5KA0KCQkJCSdtYXBwZXInLCAnbWFwJywgYXJyYXkoDQoJCQkJCSd0YWcnID0+ICR0YWcsDQoJCQkJCSdhdHRyaWJ1dGVzJyA9PiAkYXR0cmlidXRlcw0KCQkJCSkNCgkJCSk7DQoJCQlyZXR1cm4gZmFsc2U7DQoJCX0NCgkJaWYgKCBlbXB0eSggJGF0dHJpYnV0ZXNbJ25hbWUnXSApICkgew0KCQkJdHJpZ2dlcl9lcnJvciggc3ByaW50ZiggX18oICJXcm9uZyBuYW1lIGZvciBzaG9ydGNvZGU6JXMuIE5hbWUgcmVxdWlyZWQiLCAianNfY29tcG9zZXIiICksICR0YWcgKSApOw0KCQl9IGVsc2VpZiAoIGVtcHR5KCAkYXR0cmlidXRlc1snYmFzZSddICkgKSB7DQoJCQl0cmlnZ2VyX2Vycm9yKCBzcHJpbnRmKCBfXyggIldyb25nIGJhc2UgZm9yIHNob3J0Y29kZTolcy4gQmFzZSByZXF1aXJlZCIsICJqc19jb21wb3NlciIgKSwgJHRhZyApICk7DQoJCX0gZWxzZSB7DQoJCQkJDQoJCQkjIHN0YXJ0OiBtb2RpZmllZCBieSBBcmxpbmQgTnVzaGkNCgkJCSRhdHRyaWJ1dGVzID0gYXBwbHlfZmlsdGVycygnbGFiX3ZjX21hcF9hdHRycycsICRhdHRyaWJ1dGVzKTsNCgkJCQ0KCQkJaWYoICEgJGF0dHJpYnV0ZXMgJiYgaXNzZXQoc2VsZjo6JHNjWyRuYW1lXSkpDQoJCQl7DQoJCQkJdW5zZXQoc2VsZjo6JHNjWyRuYW1lXSk7DQoJCQkJcmV0dXJuIGZhbHNlOw0KCQkJfQ0KCQkJIyBlbmQ6IG1vZGlmaWVkIGJ5IEFybGluZCBOdXNoaQ0KCQkJDQoJCQlzZWxmOjokc2NbJHRhZ10gPSAkYXR0cmlidXRlczsNCgkJCXNlbGY6OiRzY1skdGFnXVsncGFyYW1zJ10gPSBBcnJheSgpOw0KCQkJaWYgKCAhIGVtcHR5KCAkYXR0cmlidXRlc1sncGFyYW1zJ10gKSApIHsNCgkJCQlmb3JlYWNoICggJGF0dHJpYnV0ZXNbJ3BhcmFtcyddIGFzICRhdHRyaWJ1dGUgKSB7DQoJCQkJCSRhdHRyaWJ1dGUgPSBhcHBseV9maWx0ZXJzKCd2Y19tYXBwZXJfYXR0cmlidXRlJywgJGF0dHJpYnV0ZSwgJHRhZyk7DQoJCQkJCSRhdHRyaWJ1dGUgPSBhcHBseV9maWx0ZXJzKCd2Y19tYXBwZXJfYXR0cmlidXRlXycuJGF0dHJpYnV0ZVsndHlwZSddLCAkYXR0cmlidXRlLCAkdGFnKTsNCgkJCQkJc2VsZjo6JHNjWyR0YWddWydwYXJhbXMnXVtdID0gJGF0dHJpYnV0ZTsNCgkJCQl9DQoJCQl9DQoJCQl2aXN1YWxfY29tcG9zZXIoKS0+YWRkU2hvcnRDb2RlKCBzZWxmOjokc2NbJHRhZ10gKTsNCgkJfQ0KCX0NCg0KCS8qKg0KCSAqIEdlbmVyYXRlcyBsaXN0IG9mIHNob3J0Y29kZXMgdGFraW5nIGludG8gYWNjb3VudCB0aGUgYWNjZXNzIHJ1bGVzIGZvciBzaG9ydGNvZGVzIGZyb20gVkMgU2V0dGluZ3MgcGFnZS4NCgkgKg0KCSAqIFRoaXMgbWV0aG9kIHBhcnNlcyB0aGUgbGlzdCBvZiBtYXBwZWQgc2hvcnRjb2RlcyBhbmQgY3JlYXRlcyBjYXRlZ29yaWVzIGxpc3QgZm9yIHVzZXJzLg0KCSAqDQoJICogQHN0YXRpYw0KCSAqIEBwYXJhbSBib29sICRmb3JjZSAtIGZvcmNlIGRhdGEgZ2VuZXJhdGlvbiBldmVuIGRhdGEgYWxyZWFkeSBnZW5lcmF0ZWQuDQoJICovDQoJcHJvdGVjdGVkIHN0YXRpYyBmdW5jdGlvbiBnZW5lcmF0ZVVzZXJEYXRhKCAkZm9yY2UgPSBmYWxzZSApIHsNCgkJaWYgKCAhICRmb3JjZSAmJiBzZWxmOjokdXNlcl9zYyAhPT0gZmFsc2UgJiYgc2VsZjo6JHVzZXJfY2F0ZWdvcmllcyAhPT0gZmFsc2UgKSByZXR1cm47DQoNCgkJJHNldHRpbmdzID0gc2VsZjo6Z2V0U2V0dGluZ3MoKTsNCgkJc2VsZjo6JHVzZXJfc2MgPSBzZWxmOjokdXNlcl9jYXRlZ29yaWVzID0gc2VsZjo6JHVzZXJfc29ydGVkX3NjID0gYXJyYXkoKTsNCgkJZm9yZWFjaCAoIHNlbGY6OiRzYyBhcyAkbmFtZSA9PiAkdmFsdWVzICkgew0KCQkJaWYgKCAhIGlzc2V0KCAkc2V0dGluZ3Nbc2VsZjo6JHVzZXJfcm9sZV1bJ3Nob3J0Y29kZXMnXSApDQoJCQkgIHx8ICggaXNzZXQoICRzZXR0aW5nc1tzZWxmOjokdXNlcl9yb2xlXVsnc2hvcnRjb2RlcyddWyRuYW1lXSApICYmIChpbnQpJHNldHRpbmdzW3NlbGY6OiR1c2VyX3JvbGVdWydzaG9ydGNvZGVzJ11bJG5hbWVdID09IDEgKQ0KCQkJKSB7DQoJCQkJaWYgKCAkbmFtZSAhPSAndmNfY29sdW1uJyAmJiAoICEgaXNzZXQoICR2YWx1ZXNbJ2NvbnRlbnRfZWxlbWVudCddICkgfHwgJHZhbHVlc1snY29udGVudF9lbGVtZW50J10gPT09IHRydWUgKSApIHsNCgkJCQkJJGNhdGVnb3JpZXMgPSBpc3NldCggJHZhbHVlc1snY2F0ZWdvcnknXSApID8gJHZhbHVlc1snY2F0ZWdvcnknXSA6ICdfb3RoZXJfY2F0ZWdvcnlfJzsNCgkJCQkJJHZhbHVlc1snX2NhdGVnb3J5X2lkcyddID0gYXJyYXkoKTsNCgkJCQkJaWYgKCBpc19hcnJheSggJGNhdGVnb3JpZXMgKSApIHsNCgkJCQkJCWZvcmVhY2ggKCAkY2F0ZWdvcmllcyBhcyAkYyApIHsNCgkJCQkJCQlpZiAoIGFycmF5X3NlYXJjaCggJGMsIHNlbGY6OiR1c2VyX2NhdGVnb3JpZXMgKSA9PT0gZmFsc2UgKSBzZWxmOjokdXNlcl9jYXRlZ29yaWVzW10gPSAkYzsNCgkJCQkJCQkkdmFsdWVzWydfY2F0ZWdvcnlfaWRzJ11bXSA9IG1kNSggJGMgKTsgLy8gYXJyYXlfc2VhcmNoKCRjYXRlZ29yeSwgc2VsZjo6JGNhdGVnb3JpZXMpOw0KCQkJCQkJfQ0KCQkJCQl9IGVsc2Ugew0KCQkJCQkJaWYgKCBhcnJheV9zZWFyY2goICRjYXRlZ29yaWVzLCBzZWxmOjokdXNlcl9jYXRlZ29yaWVzICkgPT09IGZhbHNlICkgc2VsZjo6JHVzZXJfY2F0ZWdvcmllc1tdID0gJGNhdGVnb3JpZXM7DQoJCQkJCQkkdmFsdWVzWydfY2F0ZWdvcnlfaWRzJ11bXSA9IG1kNSggJGNhdGVnb3JpZXMgKTsgLy8gYXJyYXlfc2VhcmNoKCRjYXRlZ29yeSwgc2VsZjo6JGNhdGVnb3JpZXMpOw0KCQkJCQl9DQoNCgkJCQl9DQoJCQkJc2VsZjo6JHVzZXJfc2NbJG5hbWVdID0gJHZhbHVlczsNCgkJCQlzZWxmOjokdXNlcl9zb3J0ZWRfc2NbXSA9ICR2YWx1ZXM7DQoJCQl9DQoNCgkJfQ0KCQlAdXNvcnQoIHNlbGY6OiR1c2VyX3NvcnRlZF9zYywgYXJyYXkoICJXUEJNYXAiLCAic29ydCIgKSApOw0KCX0NCg0KCS8qKg0KCSAqIEdldCBtYXBwZWQgc2hvcnRjb2RlIHNldHRpbmdzLg0KCSAqDQoJICogQHN0YXRpYw0KCSAqIEByZXR1cm4gYXJyYXkNCgkgKi8NCglwdWJsaWMgc3RhdGljIGZ1bmN0aW9uIGdldFNob3J0Q29kZXMoKSB7DQoJCXJldHVybiBzZWxmOjokc2M7DQoJfQ0KDQoJLyoqDQoJICogR2V0IHNvcnRlZCBsaXN0IG9mIG1hcHBlZCBzaG9ydGNvZGUgc2V0dGluZ3MgZm9yIGN1cnJlbnQgdXNlci4NCgkgKg0KCSAqIFNvcnRpbmcgZGVwZW5kcyBvbiB0aGUgd2VpZ2h0IGF0dHJpYnV0ZSBhbmQgbWFwcGluZyBvcmRlci4NCgkgKg0KCSAqIEBzdGF0aWMNCgkgKiBAcmV0dXJuIGFycmF5DQoJICovDQoJcHVibGljIHN0YXRpYyBmdW5jdGlvbiBnZXRTb3J0ZWRVc2VyU2hvcnRDb2RlcygpIHsNCgkJc2VsZjo6Z2VuZXJhdGVVc2VyRGF0YSgpOw0KCQlyZXR1cm4gc2VsZjo6JHVzZXJfc29ydGVkX3NjOw0KCX0NCg0KCS8qKg0KCSAqIEdldCBsaXN0IG9mIG1hcHBlZCBzaG9ydGNvZGUgc2V0dGluZ3MgZm9yIGN1cnJlbnQgdXNlci4NCgkgKiBAc3RhdGljDQoJICogQHJldHVybiBhcnJheSAtIGFzc29jaWF0ZWQgYXJyYXkgb2Ygc2hvcnRjb2RlcyBzZXR0aW5ncyB3aXRoIHRhZyBhcyB0aGUga2V5Lg0KCSAqLw0KCXB1YmxpYyBzdGF0aWMgZnVuY3Rpb24gZ2V0VXNlclNob3J0Q29kZXMoKSB7DQoJCXNlbGY6OmdlbmVyYXRlVXNlckRhdGEoKTsNCgkJcmV0dXJuIHNlbGY6OiR1c2VyX3NjOw0KCX0NCg0KCS8qKg0KCSAqIEdldCBtYXBwZWQgc2hvcnRjb2RlIHNldHRpbmdzIGJ5IHRhZy4NCgkgKg0KCSAqIEBzdGF0aWMNCgkgKiBAcGFyYW0gJHRhZyAtIHNob3J0Y29kZSB0YWcuDQoJICogQHJldHVybiBhcnJheQ0KCSAqLw0KCXB1YmxpYyBzdGF0aWMgZnVuY3Rpb24gZ2V0U2hvcnRDb2RlKCAkdGFnICkgew0KCQlyZXR1cm4gc2VsZjo6JHNjWyR0YWddOw0KCX0NCg0KCS8qKg0KCSAqIEdldCBhbGwgY2F0ZWdvcmllcyBmb3IgbWFwcGVkIHNob3J0Y29kZXMuDQoJICoNCgkgKiBAc3RhdGljDQoJICogQHJldHVybiBhcnJheQ0KCSAqLw0KCXB1YmxpYyBzdGF0aWMgZnVuY3Rpb24gZ2V0Q2F0ZWdvcmllcygpIHsNCgkJcmV0dXJuIHNlbGY6OiRjYXRlZ29yaWVzOw0KCX0NCg0KCS8qKg0KCSAqIEdldCBhbGwgY2F0ZWdvcmllcyBmb3IgY3VycmVudCB1c2VyLg0KCSAqDQoJICogQ2F0ZWdvcnkgaXMgYWRkZWQgdG8gdGhlIGxpc3Qgd2hlbiBhdCBsZWFzdCBvbmUgc2hvcnRjb2RlIG9mIHRoaXMgY2F0ZWdvcnkgaXMgYWxsb3dlZCBmb3IgY3VycmVudCB1c2VyDQoJICogYnkgVmMgYWNjZXNzIHJ1bGVzLg0KCSAqDQoJICogQHN0YXRpYw0KCSAqIEByZXR1cm4gYm9vbA0KCSAqLw0KCXB1YmxpYyBzdGF0aWMgZnVuY3Rpb24gZ2V0VXNlckNhdGVnb3JpZXMoKSB7DQoJCXNlbGY6OmdlbmVyYXRlVXNlckRhdGEoKTsNCgkJcmV0dXJuIHNlbGY6OiR1c2VyX2NhdGVnb3JpZXM7DQoJfQ0KDQoJLyoqDQoJICogRHJvcCBzaG9ydGNvZGUgcGFyYW0uDQoJICoNCgkgKiBAc3RhdGljDQoJICogQHBhcmFtICRuYW1lDQoJICogQHBhcmFtICRhdHRyaWJ1dGVfbmFtZQ0KCSAqLw0KCXB1YmxpYyBzdGF0aWMgZnVuY3Rpb24gZHJvcFBhcmFtKCAkbmFtZSwgJGF0dHJpYnV0ZV9uYW1lICkgew0KCQlpZiAoICEgc2VsZjo6JGlzX2luaXQgKSB7DQoJCQl2Y19tYXBwZXIoKS0+YWRkQWN0aXZpdHkoDQoJCQkJJ21hcHBlcicsICdkcm9wX3BhcmFtJywgYXJyYXkoDQoJCQkJCSduYW1lJyA9PiAkbmFtZSwNCgkJCQkJJ2F0dHJpYnV0ZV9uYW1lJyA9PiAkYXR0cmlidXRlX25hbWUNCgkJCQkpDQoJCQkpOw0KCQkJcmV0dXJuOw0KCQl9DQoJCWZvcmVhY2ggKCBzZWxmOjokc2NbJG5hbWVdWydwYXJhbXMnXSBhcyAkaW5kZXggPT4gJHBhcmFtICkgew0KCQkJaWYgKCAkcGFyYW1bJ3BhcmFtX25hbWUnXSA9PSAkYXR0cmlidXRlX25hbWUgKSB7DQoJCQkJYXJyYXlfc3BsaWNlKCBzZWxmOjokc2NbJG5hbWVdWydwYXJhbXMnXSwgJGluZGV4LCAxICk7DQoJCQkJcmV0dXJuOw0KCQkJfQ0KCQl9DQoJfQ0KDQoJLyoqDQoJICogUmV0dXJucyBwYXJhbSBzZXR0aW5ncyBmb3IgbWFwcGVkIHNob3J0Y29kZXMuDQoJICoNCgkgKiBAc3RhdGljDQoJICogQHBhcmFtICR0YWcNCgkgKiBAcGFyYW0gJHBhcmFtX25hbWUNCgkgKg0KCSAqIEByZXR1cm4gYm9vbHwgYXJyYXkNCgkgKi8NCglwdWJsaWMgc3RhdGljIGZ1bmN0aW9uIGdldFBhcmFtKCAkdGFnLCAkcGFyYW1fbmFtZSApIHsNCgkJaWYgKCAhIGlzc2V0KCBzZWxmOjokc2NbJHRhZ10gKSApDQoJCQlyZXR1cm4gdHJpZ2dlcl9lcnJvciggc3ByaW50ZiggX18oICJXcm9uZyBuYW1lIGZvciBzaG9ydGNvZGU6JXMuIE5hbWUgcmVxdWlyZWQiLCAianNfY29tcG9zZXIiICksICR0YWcgKSApOw0KCQlmb3JlYWNoICggc2VsZjo6JHNjWyR0YWddWydwYXJhbXMnXSBhcyAkaW5kZXggPT4gJHBhcmFtICkgew0KCQkJaWYgKCAkcGFyYW1bJ3BhcmFtX25hbWUnXSA9PSAkcGFyYW1fbmFtZSApIHsNCgkJCQlyZXR1cm4gc2VsZjo6JHNjWyR0YWddWydwYXJhbXMnXVskaW5kZXhdOw0KCQkJfQ0KCQl9DQoJCXJldHVybiBmYWxzZTsNCgl9DQoNCgkvKioNCgkgKiBBZGQgbmV3IHBhcmFtIHRvIHNob3J0Y29kZSBwYXJhbXMgbGlzdC4NCgkgKg0KCSAqIEBzdGF0aWMNCgkgKiBAcGFyYW0gJG5hbWUNCgkgKiBAcGFyYW0gYXJyYXkgJGF0dHJpYnV0ZQ0KCSAqIEByZXR1cm4gYm9vbA0KCSAqLw0KCXB1YmxpYyBzdGF0aWMgZnVuY3Rpb24gYWRkUGFyYW0oICRuYW1lLCAkYXR0cmlidXRlID0gQXJyYXkoKSApIHsNCgkJaWYgKCAhIHNlbGY6OiRpc19pbml0ICkgew0KCQkJdmNfbWFwcGVyKCktPmFkZEFjdGl2aXR5KA0KCQkJCSdtYXBwZXInLCAnYWRkX3BhcmFtJywgYXJyYXkoDQoJCQkJCSduYW1lJyA9PiAkbmFtZSwNCgkJCQkJJ2F0dHJpYnV0ZScgPT4gJGF0dHJpYnV0ZQ0KCQkJCSkNCgkJCSk7DQoJCQlyZXR1cm47DQoJCX0NCgkJaWYgKCAhIGlzc2V0KCBzZWxmOjokc2NbJG5hbWVdICkgKQ0KCQkJcmV0dXJuIHRyaWdnZXJfZXJyb3IoIHNwcmludGYoIF9fKCAiV3JvbmcgbmFtZSBmb3Igc2hvcnRjb2RlOiVzLiBOYW1lIHJlcXVpcmVkIiwgImpzX2NvbXBvc2VyIiApLCAkbmFtZSApICk7DQoJCWVsc2VpZiAoICEgaXNzZXQoICRhdHRyaWJ1dGVbJ3BhcmFtX25hbWUnXSApICkgew0KCQkJdHJpZ2dlcl9lcnJvciggc3ByaW50ZiggX18oICJXcm9uZyBhdHRyaWJ1dGUgZm9yICclcycgc2hvcnRjb2RlLiBBdHRyaWJ1dGUgJ3BhcmFtX25hbWUnIHJlcXVpcmVkIiwgImpzX2NvbXBvc2VyIiApLCAkbmFtZSApICk7DQoJCX0gZWxzZSB7DQoNCgkJCSRyZXBsYWNlZCA9IGZhbHNlOw0KDQoJCQlmb3JlYWNoICggc2VsZjo6JHNjWyRuYW1lXVsncGFyYW1zJ10gYXMgJGluZGV4ID0+ICRwYXJhbSApIHsNCgkJCQlpZiAoICRwYXJhbVsncGFyYW1fbmFtZSddID09ICRhdHRyaWJ1dGVbJ3BhcmFtX25hbWUnXSApIHsNCgkJCQkJJHJlcGxhY2VkID0gdHJ1ZTsNCgkJCQkJc2VsZjo6JHNjWyRuYW1lXVsncGFyYW1zJ11bJGluZGV4XSA9ICRhdHRyaWJ1dGU7DQoJCQkJfQ0KCQkJfQ0KCQkJaWYgKCAkcmVwbGFjZWQgPT09IGZhbHNlICkgc2VsZjo6JHNjWyRuYW1lXVsncGFyYW1zJ11bXSA9ICRhdHRyaWJ1dGU7DQoJCQl2aXN1YWxfY29tcG9zZXIoKS0+YWRkU2hvcnRDb2RlKCBzZWxmOjokc2NbJG5hbWVdICk7DQoJCX0NCgl9DQoNCgkvKioNCgkgKiBDaGFuZ2UgcGFyYW0gYXR0cmlidXRlcyBvZiBtYXBwZWQgc2hvcnRjb2RlLg0KCSAqDQoJICogQHN0YXRpYw0KCSAqIEBwYXJhbSAkbmFtZQ0KCSAqIEBwYXJhbSBhcnJheSAkYXR0cmlidXRlDQoJICogQHJldHVybiBib29sDQoJICovDQoJcHVibGljIHN0YXRpYyBmdW5jdGlvbiBtdXRhdGVQYXJhbSggJG5hbWUsICRhdHRyaWJ1dGUgPSBBcnJheSgpICkgew0KCQlpZiAoICEgc2VsZjo6JGlzX2luaXQgKSB7DQoJCQl2Y19tYXBwZXIoKS0+YWRkQWN0aXZpdHkoDQoJCQkJJ21hcHBlcicsICdtdXRhdGVfcGFyYW0nLCBhcnJheSgNCgkJCQkJJ25hbWUnID0+ICRuYW1lLA0KCQkJCQknYXR0cmlidXRlJyA9PiAkYXR0cmlidXRlDQoJCQkJKQ0KCQkJKTsNCgkJCXJldHVybiBmYWxzZTsNCgkJfQ0KCQlpZiAoICEgaXNzZXQoIHNlbGY6OiRzY1skbmFtZV0gKSApDQoJCQlyZXR1cm4gdHJpZ2dlcl9lcnJvciggc3ByaW50ZiggX18oICJXcm9uZyBuYW1lIGZvciBzaG9ydGNvZGU6JXMuIE5hbWUgcmVxdWlyZWQiLCAianNfY29tcG9zZXIiICksICRuYW1lICkgKTsNCgkJZWxzZWlmICggISBpc3NldCggJGF0dHJpYnV0ZVsncGFyYW1fbmFtZSddICkgKSB7DQoJCQl0cmlnZ2VyX2Vycm9yKCBzcHJpbnRmKCBfXyggIldyb25nIGF0dHJpYnV0ZSBmb3IgJyVzJyBzaG9ydGNvZGUuIEF0dHJpYnV0ZSAncGFyYW1fbmFtZScgcmVxdWlyZWQiLCAianNfY29tcG9zZXIiICksICRuYW1lICkgKTsNCgkJfSBlbHNlIHsNCg0KCQkJJHJlcGxhY2VkID0gZmFsc2U7DQoNCgkJCWZvcmVhY2ggKCBzZWxmOjokc2NbJG5hbWVdWydwYXJhbXMnXSBhcyAkaW5kZXggPT4gJHBhcmFtICkgew0KCQkJCWlmICggJHBhcmFtWydwYXJhbV9uYW1lJ10gPT0gJGF0dHJpYnV0ZVsncGFyYW1fbmFtZSddICkgew0KCQkJCQkkcmVwbGFjZWQgPSB0cnVlOw0KCQkJCQlzZWxmOjokc2NbJG5hbWVdWydwYXJhbXMnXVskaW5kZXhdID0gYXJyYXlfbWVyZ2UoICRwYXJhbSwgJGF0dHJpYnV0ZSApOw0KCQkJCX0NCgkJCX0NCg0KCQkJaWYgKCAkcmVwbGFjZWQgPT09IGZhbHNlICkgc2VsZjo6JHNjWyRuYW1lXVsncGFyYW1zJ11bXSA9ICRhdHRyaWJ1dGU7DQoNCgkJCXZpc3VhbF9jb21wb3NlcigpLT5hZGRTaG9ydENvZGUoIHNlbGY6OiRzY1skbmFtZV0gKTsNCgkJfQ0KCQlyZXR1cm4gdHJ1ZTsNCgl9DQoNCgkvKioNCgkgKiBSZW1vdmVzIHNob3J0Y29kZSBmcm9tIG1hcHBpbmcgbGlzdC4NCgkgKg0KCSAqIEBzdGF0aWMNCgkgKiBAcGFyYW0gJG5hbWUNCgkgKiBAcmV0dXJuIGJvb2wNCgkgKi8NCglwdWJsaWMgc3RhdGljIGZ1bmN0aW9uIGRyb3BTaG9ydGNvZGUoICRuYW1lICkgew0KCQlpZiAoICEgc2VsZjo6JGlzX2luaXQgKSB7DQoJCQl2Y19tYXBwZXIoKS0+YWRkQWN0aXZpdHkoDQoJCQkJJ21hcHBlcicsICdkcm9wX3Nob3J0Y29kZScsIGFycmF5KA0KCQkJCQknbmFtZScgPT4gJG5hbWUNCgkJCQkpDQoJCQkpOw0KCQkJcmV0dXJuIGZhbHNlOw0KCQl9DQoJCXVuc2V0KCBzZWxmOjokc2NbJG5hbWVdICk7DQoJCXZpc3VhbF9jb21wb3NlcigpLT5yZW1vdmVTaG9ydENvZGUoICRuYW1lICk7DQoNCgl9DQoNCgkvKioNCgkgKiBNb2RpZnkgc2hvcnRjb2RlJ3MgbWFwcGVkIHNldHRpbmdzLg0KCSAqIFlvdSBjYW4gbW9kaWZ5IG9ubHkgb25lIG9wdGlvbiBvZiB0aGUgZ3JvdXAgb3B0aW9ucy4NCgkgKiBDYWxsIHRoaXMgbWV0aG9kIHdpdGggJHNldHRpbmdzX25hbWUgcGFyYW0gYXMgYXNzb2NpYXRlZCBhcnJheSB0byBtYXNzIG1vZGlmaWNhdGlvbnMuDQoJICoNCgkgKiBAc3RhdGljDQoJICogQHBhcmFtICRuYW1lICAgICAgICAgLSBzaG9ydGNvZGUnIG5hbWUuDQoJICogQHBhcmFtICRzZXR0aW5nX25hbWUgLSBvcHRpb24ga2V5IG5hbWUgb3IgdGhlIGFycmF5IG9mIG9wdGlvbnMuDQoJICogQHBhcmFtICR2YWx1ZSAgICAgICAgLSB2YWx1ZSBvZiBzZXR0aW5ncyBpZiAkc2V0dGluZ19uYW1lIGlzIG9wdGlvbiBrZXkuDQoJICogQHJldHVybiBhcnJheXxib29sDQoJICovDQoJcHVibGljIHN0YXRpYyBmdW5jdGlvbiBtb2RpZnkoICRuYW1lLCAkc2V0dGluZ19uYW1lLCAkdmFsdWUgPSAnJyApIHsNCgkJaWYgKCAhIHNlbGY6OiRpc19pbml0ICkgew0KCQkJdmNfbWFwcGVyKCktPmFkZEFjdGl2aXR5KA0KCQkJCSdtYXBwZXInLCAnbW9kaWZ5JywgYXJyYXkoDQoJCQkJCSduYW1lJyA9PiAkbmFtZSwNCgkJCQkJJ3NldHRpbmdfbmFtZScgPT4gJHNldHRpbmdfbmFtZSwNCgkJCQkJJ3ZhbHVlJyA9PiAkdmFsdWUNCgkJCQkpDQoJCQkpOw0KCQkJcmV0dXJuIGZhbHNlOw0KCQl9DQoJCWlmICggISBpc3NldCggc2VsZjo6JHNjWyRuYW1lXSApICkNCgkJCXJldHVybiB0cmlnZ2VyX2Vycm9yKCBzcHJpbnRmKCBfXyggIldyb25nIG5hbWUgZm9yIHNob3J0Y29kZTolcy4gTmFtZSByZXF1aXJlZCIsICJqc19jb21wb3NlciIgKSwgJG5hbWUgKSApOw0KCQllbHNlaWYgKCAkc2V0dGluZ19uYW1lID09PSAnYmFzZScgKSB7DQoJCQlyZXR1cm4gdHJpZ2dlcl9lcnJvciggc3ByaW50ZiggX18oICJXcm9uZyBzZXR0aW5nX25hbWUgZm9yIHNob3J0Y29kZTolcy4gQmFzZSBjYW4ndCBiZSBtb2RpZmllZC4iLCAianNfY29tcG9zZXIiICksICRuYW1lICkgKTsNCgkJfQ0KCQlpZiAoIGlzX2FycmF5KCAkc2V0dGluZ19uYW1lICkgKSB7DQoJCQlmb3JlYWNoICggJHNldHRpbmdfbmFtZSBhcyAka2V5ID0+ICR2YWx1ZSApIHsNCgkJCQlzZWxmOjptb2RpZnkoICRuYW1lLCAka2V5LCAkdmFsdWUgKTsNCgkJCX0NCgkJfSBlbHNlIHsNCgkJCXNlbGY6OiRzY1skbmFtZV1bJHNldHRpbmdfbmFtZV0gPSAkdmFsdWU7DQoJCX0NCgkJcmV0dXJuIHNlbGY6OiRzYzsNCgl9DQoNCgkvKioNCgkgKiBSZXR1cm5zICJ8IiBzZXBhcmF0ZWQgbGlzdCBvZiBtYXBwZWQgc2hvcnRjb2RlIHRhZ3MuDQoJICoNCgkgKiBAc3RhdGljDQoJICogQHJldHVybiBzdHJpbmcNCgkgKi8NCglwdWJsaWMgc3RhdGljIGZ1bmN0aW9uIGdldFRhZ3NSZWdleHAoKSB7DQoJCWlmICggZW1wdHkoIHNlbGY6OiR0YWdzX3JlZ2V4cCApICkgew0KCQkJc2VsZjo6JHRhZ3NfcmVnZXhwID0gaW1wbG9kZSggJ3wnLCBhcnJheV9rZXlzKCBzZWxmOjokc2MgKSApOw0KCQl9DQoJCXJldHVybiBzZWxmOjokdGFnc19yZWdleHA7DQoJfQ0KDQoJLyoqDQoJICogU29ydGluZyBtZXRob2QgZm9yIFdQQk1hcDo6Z2VuZXJhdGVVc2VyRGF0YSBtZXRob2QuIENhbGxlZCBieSB1c29ydCBwaHAgZnVuY3Rpb24uDQoJICoNCgkgKiBAc3RhdGljDQoJICogQHBhcmFtICRhDQoJICogQHBhcmFtICRiDQoJICogQHJldHVybiBpbnQNCgkgKi8NCglwdWJsaWMgc3RhdGljIGZ1bmN0aW9uIHNvcnQoICRhLCAkYiApIHsNCgkJJGFfd2VpZ2h0ID0gaXNzZXQoICRhWyd3ZWlnaHQnXSApID8gKGludCkkYVsnd2VpZ2h0J10gOiAwOw0KCQkkYl93ZWlnaHQgPSBpc3NldCggJGJbJ3dlaWdodCddICkgPyAoaW50KSRiWyd3ZWlnaHQnXSA6IDA7DQoJCWlmICggJGFfd2VpZ2h0ID09ICRiX3dlaWdodCApIHsNCgkJCSRjbXBhID0gYXJyYXlfc2VhcmNoKCAkYSwgc2VsZjo6JHVzZXJfc29ydGVkX3NjICk7DQoJCQkkY21wYiA9IGFycmF5X3NlYXJjaCggJGIsIHNlbGY6OiR1c2VyX3NvcnRlZF9zYyApOw0KCQkJcmV0dXJuICggJGNtcGEgPiAkY21wYiApID8gMSA6IC0gMTsNCgkJfQ0KCQlyZXR1cm4gKCAkYV93ZWlnaHQgPCAkYl93ZWlnaHQgKSA/IDEgOiAtIDE7DQoJfQ0KfQ==',
	'include/classes/shortcodes/shortcodes.php' => 'PD9waHANCi8qKg0KICogV1BCYWtlcnkgVmlzdWFsIENvbXBvc2VyIFNob3J0Y29kZXMgbWFpbg0KICoNCiAqIEBwYWNrYWdlIFdQQmFrZXJ5VmlzdWFsQ29tcG9zZXINCiAqDQogKi8NCg0KLyogYWJzdHJhY3QgVmlzdWFsQ29tcG9zZXIgY2xhc3MgdG8gY3JlYXRlIHN0cnVjdHVyYWwgb2JqZWN0IG9mIGFueSB0eXBlICovDQppZiAoICEgY2xhc3NfZXhpc3RzKCAnV1BCYWtlcnlWaXN1YWxDb21wb3NlckFic3RyYWN0JyApICkgew0KCWFic3RyYWN0IGNsYXNzIFdQQmFrZXJ5VmlzdWFsQ29tcG9zZXJBYnN0cmFjdCB7DQoJCXB1YmxpYyBzdGF0aWMgJGNvbmZpZzsNCgkJcHJvdGVjdGVkICRpc19wbHVnaW4gPSB0cnVlOw0KCQlwcm90ZWN0ZWQgJGlzX3RoZW1lID0gZmFsc2U7DQoJCXByb3RlY3RlZCAkZGlzYWJsZV91cGRhdGVyID0gZmFsc2U7DQoJCXByb3RlY3RlZCAkc2V0dGluZ3NfYXNfdGhlbWUgPSBmYWxzZTsNCgkJcHJvdGVjdGVkICRhc19uZXR3b3JrX3BsdWdpbiA9IGZhbHNlOw0KCQlwcm90ZWN0ZWQgJGlzX2luaXQgPSBmYWxzZTsNCg0KCQlwdWJsaWMgZnVuY3Rpb24gX19jb25zdHJ1Y3QoKSB7DQoJCX0NCg0KCQlwdWJsaWMgZnVuY3Rpb24gaW5pdCggJHNldHRpbmdzICkgew0KCQkJc2VsZjo6JGNvbmZpZyA9IChhcnJheSkkc2V0dGluZ3M7DQoJCX0NCg0KCQlwdWJsaWMgZnVuY3Rpb24gYWRkQWN0aW9uKCAkYWN0aW9uLCAkbWV0aG9kLCAkcHJpb3JpdHkgPSAxMCApIHsNCgkJCWFkZF9hY3Rpb24oICRhY3Rpb24sIGFycmF5KCAmJHRoaXMsICRtZXRob2QgKSwgJHByaW9yaXR5ICk7DQoJCX0NCg0KCQlwdWJsaWMgZnVuY3Rpb24gcmVtb3ZlQWN0aW9uKCAkYWN0aW9uLCAkbWV0aG9kLCAkcHJpb3JpdHkgPSAxMCApIHsNCgkJCXJldHVybiByZW1vdmVfYWN0aW9uKCAkYWN0aW9uLCBhcnJheSggJHRoaXMsICRtZXRob2QgKSwgJHByaW9yaXR5ICk7DQoJCX0NCg0KCQlwdWJsaWMgZnVuY3Rpb24gYWRkRmlsdGVyKCAkZmlsdGVyLCAkbWV0aG9kLCAkcHJpb3JpdHkgPSAxMCApIHsNCgkJCXJldHVybiBhZGRfZmlsdGVyKCAkZmlsdGVyLCBhcnJheSggJiR0aGlzLCAkbWV0aG9kICksICRwcmlvcml0eSApOw0KCQl9DQoNCgkJcHVibGljIGZ1bmN0aW9uIHJlbW92ZUZpbHRlciggJGZpbHRlciwgJG1ldGhvZCwgJHByaW9yaXR5ID0gMTAgKSB7DQoJCQlyZW1vdmVfZmlsdGVyKCAkZmlsdGVyLCBhcnJheSggJiR0aGlzLCAkbWV0aG9kICksICRwcmlvcml0eSApOw0KCQl9DQoNCgkJLyogU2hvcnRjb2RlIG1ldGhvZHMgKi8NCgkJcHVibGljIGZ1bmN0aW9uIGFkZFNob3J0Q29kZSggJHRhZywgJGZ1bmMgKSB7DQoJCQlhZGRfc2hvcnRjb2RlKCAkdGFnLCAkZnVuYyApOw0KCQl9DQoNCgkJcHVibGljIGZ1bmN0aW9uIGRvU2hvcnRDb2RlKCAkY29udGVudCApIHsNCgkJCWRvX3Nob3J0Y29kZSggJGNvbnRlbnQgKTsNCgkJfQ0KDQoJCXB1YmxpYyBmdW5jdGlvbiByZW1vdmVTaG9ydENvZGUoICR0YWcgKSB7DQoJCQlyZW1vdmVfc2hvcnRjb2RlKCAkdGFnICk7DQoJCX0NCg0KCQlwdWJsaWMgZnVuY3Rpb24gcG9zdCggJHBhcmFtICkgew0KCQkJcmV0dXJuIGlzc2V0KCAkX1BPU1RbJHBhcmFtXSApID8gJF9QT1NUWyRwYXJhbV0gOiBudWxsOw0KCQl9DQoNCgkJcHVibGljIGZ1bmN0aW9uIGdldCggJHBhcmFtICkgew0KCQkJcmV0dXJuIGlzc2V0KCAkX0dFVFskcGFyYW1dICkgPyAkX0dFVFskcGFyYW1dIDogbnVsbDsNCgkJfQ0KDQoJCS8qKg0KCQkgKiBAZGVwcmVjYXRlZA0KCQkgKiBAcGFyYW0gJGFzc2V0DQoJCSAqIEByZXR1cm4gc3RyaW5nDQoJCSAqLw0KCQlwdWJsaWMgZnVuY3Rpb24gYXNzZXRVUkwoICRhc3NldCApIHsNCgkJCXJldHVybiB2Y19hc3NldF91cmwoICRhc3NldCApOw0KCQl9DQoNCgkJcHVibGljIGZ1bmN0aW9uIGFzc2V0UGF0aCggJGFzc2V0ICkgew0KCQkJcmV0dXJuIHNlbGY6OiRjb25maWdbJ0FQUF9ST09UJ10gLiBzZWxmOjokY29uZmlnWydBU1NFVFNfRElSJ10gLiAkYXNzZXQ7DQoJCX0NCg0KCQlwdWJsaWMgc3RhdGljIGZ1bmN0aW9uIGNvbmZpZyggJG5hbWUgKSB7DQoJCQlyZXR1cm4gaXNzZXQoIHNlbGY6OiRjb25maWdbJG5hbWVdICkgPyBzZWxmOjokY29uZmlnWyRuYW1lXSA6IG51bGw7DQoJCX0NCgl9DQp9DQoNCmRlZmluZSggJ1ZDX1NIT1JUQ09ERV9DVVNUT01JWkVfUFJFRklYJywgJ3ZjX3RoZW1lXycgKTsNCmRlZmluZSggJ1ZDX1NIT1JUQ09ERV9CRUZPUkVfQ1VTVE9NSVpFX1BSRUZJWCcsICd2Y190aGVtZV9iZWZvcmVfJyApOw0KZGVmaW5lKCAnVkNfU0hPUlRDT0RFX0FGVEVSX0NVU1RPTUlaRV9QUkVGSVgnLCAndmNfdGhlbWVfYWZ0ZXJfJyApOw0KZGVmaW5lKCAnVkNfU0hPUlRDT0RFX0NVU1RPTV9DU1NfRklMVEVSX1RBRycsICd2Y19zaG9ydGNvZGVzX2Nzc19jbGFzcycgKTsNCmlmICggISBjbGFzc19leGlzdHMoICdXUEJha2VyeVNob3J0Q29kZScgKSApIHsNCglhYnN0cmFjdCBjbGFzcyBXUEJha2VyeVNob3J0Q29kZSBleHRlbmRzIFdQQmFrZXJ5VmlzdWFsQ29tcG9zZXJBYnN0cmFjdCB7DQoNCgkJcHJvdGVjdGVkICRzaG9ydGNvZGU7DQoJCXByb3RlY3RlZCAkaHRtbF90ZW1wbGF0ZTsNCg0KCQlwcm90ZWN0ZWQgJGF0dHMsICRzZXR0aW5nczsNCgkJcHJvdGVjdGVkIHN0YXRpYyAkZW5xdWV1ZV9pbmRleCA9IDA7DQoJCXByb3RlY3RlZCBzdGF0aWMgJGpzX3NjcmlwdHMgPSBhcnJheSgpOw0KCQlwcm90ZWN0ZWQgc3RhdGljICRjc3Nfc2NyaXB0cyA9IGFycmF5KCk7DQoJCXByb3RlY3RlZCAkc2hvcnRjb2RlX3N0cmluZyA9ICcnOw0KDQoJCXB1YmxpYyBmdW5jdGlvbiBfX2NvbnN0cnVjdCggJHNldHRpbmdzICkgew0KCQkJJHRoaXMtPnNldHRpbmdzID0gJHNldHRpbmdzOw0KCQkJJHRoaXMtPnNob3J0Y29kZSA9ICR0aGlzLT5zZXR0aW5nc1snYmFzZSddOw0KDQoJCQkkdGhpcy0+YWRkQWN0aW9uKCAnYWRtaW5faW5pdCcsICdlbnF1ZXVlQXNzZXRzJyApOw0KCQkJJHRoaXMtPmFkZEFjdGlvbiggJ2FkbWluX2hlYWQnLCAncHJpbnRJY29uU3R5bGVzJyApOw0KCQkJLy8gaWYoJHRoaXMtPmlzQWRtaW4oKSB8fCAhc2hvcnRjb2RlX2V4aXN0cygkdGhpcy0+c2hvcnRjb2RlKSkgJHRoaXMtPmFkZFNob3J0Q29kZSgkdGhpcy0+c2hvcnRjb2RlLCBBcnJheSgkdGhpcywgJ291dHB1dCcpKTsNCgkJfQ0KDQoJCXB1YmxpYyBmdW5jdGlvbiBhZGRJbmxpbmVBbmNob3JzKCAkY29udGVudCApIHsNCgkJCXJldHVybiAoICR0aGlzLT5pc0lubGluZSgpIHx8ICR0aGlzLT5pc0VkaXRvcigpICYmICR0aGlzLT5zZXR0aW5ncyggJ2lzX2NvbnRhaW5lcicgKSA9PT0gdHJ1ZSA/ICc8c3BhbiBjbGFzcz0idmMtY29udGFpbmVyLWFuY2hvciI+PC9zcGFuPicgOiAnJyApIC4gJGNvbnRlbnQ7DQoJCX0NCg0KCQlwdWJsaWMgZnVuY3Rpb24gZW5xdWV1ZUFzc2V0cygpIHsNCgkJCWlmICggISBlbXB0eSggJHRoaXMtPnNldHRpbmdzWydhZG1pbl9lbnF1ZXVlX2pzJ10gKSApICR0aGlzLT5yZWdpc3RlckpzKCAkdGhpcy0+c2V0dGluZ3NbJ2FkbWluX2VucXVldWVfanMnXSApOw0KCQkJaWYgKCAhIGVtcHR5KCAkdGhpcy0+c2V0dGluZ3NbJ2FkbWluX2VucXVldWVfY3NzJ10gKSApICR0aGlzLT5yZWdpc3RlckNzcyggJHRoaXMtPnNldHRpbmdzWydhZG1pbl9lbnF1ZXVlX2NzcyddICk7DQoJCX0NCg0KCQkvKioNCgkJICogUHJpbnRzIG91dCB0aGUgc3R5bGVzIG5lZWRlZCB0byByZW5kZXIgdGhlIGVsZW1lbnQgaWNvbiBmb3IgdGhlIGJhY2sgZW5kIGludGVyZmFjZS4NCgkJICogT25seSBwZXJmb3JtZWQgaWYgdGhlICdpY29uJyBzZXR0aW5nIGlzIGEgdmFsaWQgVVJMLg0KCQkgKg0KCQkgKiBAcmV0dXJuIHZvaWQNCgkJICogQHNpbmNlICA0LjINCgkJICogQGF1dGhvciBCZW5qYW1pbiBJbnRhbA0KCQkgKi8NCgkJcHVibGljIGZ1bmN0aW9uIHByaW50SWNvblN0eWxlcygpIHsNCgkJCWlmICggISBmaWx0ZXJfdmFyKCAkdGhpcy0+c2V0dGluZ3MoICdpY29uJyApLCBGSUxURVJfVkFMSURBVEVfVVJMICkgKSB7DQoJCQkJcmV0dXJuOw0KCQkJfQ0KCQkJZWNobyAiDQogICAgICAgICAgICA8c3R5bGU+DQogICAgICAgICAgICAgICAgLndwYl9jb250ZW50X2VsZW1lbnRbZGF0YS1lbGVtZW50X3R5cGU9JyIgLiBlc2NfYXR0ciggJHRoaXMtPnNldHRpbmdzWydiYXNlJ10gKSAuICInXSAud3BiX2VsZW1lbnRfd3JhcHBlciwNCiAgICAgICAgICAgICAgICAudmNfc2hvcnRjb2Rlc19jb250YWluZXJbZGF0YS1lbGVtZW50X3R5cGU9JyIgLiBlc2NfYXR0ciggJHRoaXMtPnNldHRpbmdzWydiYXNlJ10gKSAuICInXSB7DQogICAgICAgICAgICAgICAgICAgIGJhY2tncm91bmQtaW1hZ2U6IHVybCgiIC4gZXNjX3VybCggJHRoaXMtPnNldHRpbmdzWydpY29uJ10gKSAuICIpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAud3BiLWNvbnRlbnQtbGF5b3V0cyAud3BiLWxheW91dC1lbGVtZW50LWJ1dHRvbltkYXRhLWVsZW1lbnQ9JyIgLiBlc2NfYXR0ciggJHRoaXMtPnNldHRpbmdzWydiYXNlJ10gKSAuICInXSAudmMtZWxlbWVudC1pY29uIHsNCiAgICAgICAgICAgICAgICAgICAgYmFja2dyb3VuZC1pbWFnZTogdXJsKCIgLiBlc2NfdXJsKCAkdGhpcy0+c2V0dGluZ3NbJ2ljb24nXSApIC4gIik7DQogICAgICAgICAgICAgICAgICAgIC13ZWJraXQtYmFja2dyb3VuZC1zaXplOiBjb250YWluOw0KICAgICAgICAgICAgICAgICAgICAtbW96LWJhY2tncm91bmQtc2l6ZTogY29udGFpbjsNCiAgICAgICAgICAgICAgICAgICAgLW1zLWJhY2tncm91bmQtc2l6ZTogY29udGFpbjsNCiAgICAgICAgICAgICAgICAgICAgLW8tYmFja2dyb3VuZC1zaXplOiBjb250YWluOw0KICAgICAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kLXNpemU6IGNvbnRhaW47DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgPC9zdHlsZT4iOw0KCQl9DQoNCgkJcHJvdGVjdGVkIGZ1bmN0aW9uIHJlZ2lzdGVySnMoICRwYXJhbSApIHsNCgkJCWlmICggaXNfYXJyYXkoICRwYXJhbSApICkgew0KCQkJCWZvcmVhY2ggKCAkcGFyYW0gYXMgJHZhbHVlICkgew0KCQkJCQkkdGhpcy0+cmVnaXN0ZXJKcyggJHZhbHVlICk7DQoJCQkJfQ0KCQkJfSBlbHNlaWYgKCBpc19zdHJpbmcoICRwYXJhbSApICYmICEgZW1wdHkoICRwYXJhbSApICkgew0KCQkJCSRuYW1lID0gJHRoaXMtPnNob3J0Y29kZSAuICdfZW5xdWV1ZV9qc18nIC4gc2VsZjo6JGVucXVldWVfaW5kZXggKys7DQoJCQkJc2VsZjo6JGpzX3NjcmlwdHNbXSA9ICRuYW1lOw0KCQkJCXdwX3JlZ2lzdGVyX3NjcmlwdCggJG5hbWUsICRwYXJhbSwgYXJyYXkoICdqcXVlcnknICksIHRpbWUoKSwgdHJ1ZSApOw0KCQkJfQ0KCQl9DQoNCgkJcHJvdGVjdGVkIGZ1bmN0aW9uIHJlZ2lzdGVyQ3NzKCAkcGFyYW0gKSB7DQoJCQlpZiAoIGlzX2FycmF5KCAkcGFyYW0gKSApIHsNCgkJCQlmb3JlYWNoICggJHBhcmFtIGFzICR2YWx1ZSApIHsNCgkJCQkJJHRoaXMtPnJlZ2lzdGVyQ3NzKCAkdmFsdWUgKTsNCgkJCQl9DQoJCQl9IGVsc2VpZiAoIGlzX3N0cmluZyggJHBhcmFtICkgKSB7DQoJCQkJJG5hbWUgPSAkdGhpcy0+c2hvcnRjb2RlIC4gJ19lbnF1ZXVlX2Nzc18nIC4gc2VsZjo6JGVucXVldWVfaW5kZXggKys7DQoJCQkJc2VsZjo6JGNzc19zY3JpcHRzW10gPSAkbmFtZTsNCgkJCQl3cF9yZWdpc3Rlcl9zdHlsZSggJG5hbWUsICRwYXJhbSwgYXJyYXkoICdqc19jb21wb3NlcicgKSwgdGltZSgpICk7DQoJCQl9DQoJCX0NCg0KCQlwdWJsaWMgc3RhdGljIGZ1bmN0aW9uIGVucXVldWVDc3MoKSB7DQoJCQlmb3JlYWNoICggc2VsZjo6JGNzc19zY3JpcHRzIGFzICRzdHlsZXNoZWV0ICkgew0KCQkJCXdwX2VucXVldWVfc3R5bGUoICRzdHlsZXNoZWV0ICk7DQoJCQl9DQoJCX0NCg0KCQlwdWJsaWMgc3RhdGljIGZ1bmN0aW9uIGVucXVldWVKcygpIHsNCgkJCWZvcmVhY2ggKCBzZWxmOjokanNfc2NyaXB0cyBhcyAkc2NyaXB0ICkgew0KCQkJCXdwX2VucXVldWVfc2NyaXB0KCAkc2NyaXB0ICk7DQoJCQl9DQoJCX0NCg0KCQlwdWJsaWMgZnVuY3Rpb24gc2hvcnRjb2RlKCAkc2hvcnRjb2RlICkgew0KDQoJCX0NCg0KCQlwcm90ZWN0ZWQgZnVuY3Rpb24gc2V0VGVtcGxhdGUoICR0ZW1wbGF0ZSApIHsNCgkJCSR0aGlzLT5odG1sX3RlbXBsYXRlID0gJHRlbXBsYXRlOw0KCQl9DQoNCgkJcHJvdGVjdGVkIGZ1bmN0aW9uIGdldFRlbXBsYXRlKCkgew0KCQkJaWYgKCBpc3NldCggJHRoaXMtPmh0bWxfdGVtcGxhdGUgKSApIHJldHVybiAkdGhpcy0+aHRtbF90ZW1wbGF0ZTsNCgkJCXJldHVybiBmYWxzZTsNCgkJfQ0KDQoJCXByb3RlY3RlZCBmdW5jdGlvbiBnZXRGaWxlTmFtZSgpIHsNCgkJCXJldHVybiAkdGhpcy0+c2hvcnRjb2RlOw0KCQl9DQoNCgkJLyoqDQoJCSAqIEZpbmQgaHRtbCB0ZW1wbGF0ZSBmb3Igc2hvcnRjb2RlIG91dHB1dC4NCgkJICovDQoJCXByb3RlY3RlZCBmdW5jdGlvbiBmaW5kU2hvcnRjb2RlVGVtcGxhdGUoKSB7DQoJCQkvLyBDaGVjayB0ZW1wbGF0ZSBwYXRoIGluIHNob3J0Y29kZSdzIG1hcHBpbmcgc2V0dGluZ3MNCgkJCWlmICggISBlbXB0eSggJHRoaXMtPnNldHRpbmdzWydodG1sX3RlbXBsYXRlJ10gKSAmJiBpc19maWxlKCAkdGhpcy0+c2V0dGluZ3MoICdodG1sX3RlbXBsYXRlJyApICkgKSB7DQoJCQkJcmV0dXJuICR0aGlzLT5zZXRUZW1wbGF0ZSggJHRoaXMtPnNldHRpbmdzWydodG1sX3RlbXBsYXRlJ10gKTsNCgkJCX0NCg0KCQkJLy8gQ2hlY2sgdGVtcGxhdGUgaW4gdGhlbWUgZGlyZWN0b3J5DQoJCQkkdXNlcl90ZW1wbGF0ZSA9IHZjX3Nob3J0Y29kZXNfdGhlbWVfdGVtcGxhdGVzX2RpciggJHRoaXMtPmdldEZpbGVuYW1lKCkgLiAnLnBocCcgKTsNCgkJCWlmICggaXNfZmlsZSggJHVzZXJfdGVtcGxhdGUgKSApIHsNCgkJCQlyZXR1cm4gJHRoaXMtPnNldFRlbXBsYXRlKCAkdXNlcl90ZW1wbGF0ZSApOw0KCQkJfQ0KDQoJCQkvLyBDaGVjayBkZWZhdWx0IHBsYWNlDQoJCQkkZGVmYXVsdF9kaXIgPSB2Y19tYW5hZ2VyKCktPmdldERlZmF1bHRTaG9ydGNvZGVzVGVtcGxhdGVzRGlyKCkgLiAnLyc7DQoJCQlpZiAoIGlzX2ZpbGUoICRkZWZhdWx0X2RpciAuICR0aGlzLT5nZXRGaWxlbmFtZSgpIC4gJy5waHAnICkgKSB7DQoJCQkJcmV0dXJuICR0aGlzLT5zZXRUZW1wbGF0ZSggJGRlZmF1bHRfZGlyIC4gJHRoaXMtPmdldEZpbGVuYW1lKCkgLiAnLnBocCcgKTsNCgkJCX0NCgkJfQ0KDQoJCXByb3RlY3RlZCBmdW5jdGlvbiBjb250ZW50KCAkYXR0cywgJGNvbnRlbnQgPSBudWxsICkgew0KCQkJcmV0dXJuICR0aGlzLT5sb2FkVGVtcGxhdGUoICRhdHRzLCAkY29udGVudCApOw0KCQl9DQoNCgkJcHJvdGVjdGVkIGZ1bmN0aW9uIGxvYWRUZW1wbGF0ZSggJGF0dHMsICRjb250ZW50ID0gbnVsbCApIHsNCgkJCQ0KCQkJIyBzdGFydDogbW9kaWZpZWQgYnkgQXJsaW5kIE51c2hpDQogICAgICAgIAlnbG9iYWwgJGF0dHNfdmFsdWVzOw0KICAgICAgICAJJGF0dHNfdmFsdWVzID0gJGF0dHM7DQogICAgICAgIAkjIGVuZDogbW9kaWZpZWQgYnkgQXJsaW5kIE51c2hpDQogICAgICAgIAkNCgkJCSRvdXRwdXQgPSAnJzsNCgkJCWlmICggISBpc19udWxsKCAkY29udGVudCApICkgJGNvbnRlbnQgPSBhcHBseV9maWx0ZXJzKCAndmNfc2hvcnRjb2RlX2NvbnRlbnRfZmlsdGVyJywgJGNvbnRlbnQgKTsNCgkJCSR0aGlzLT5maW5kU2hvcnRjb2RlVGVtcGxhdGUoKTsNCgkJCWlmICggJHRoaXMtPmh0bWxfdGVtcGxhdGUgKSB7DQoJCQkJb2Jfc3RhcnQoKTsNCgkJCQlpbmNsdWRlICggJHRoaXMtPmh0bWxfdGVtcGxhdGUgKTsNCgkJCQkkb3V0cHV0ID0gb2JfZ2V0X2NvbnRlbnRzKCk7DQoJCQkJb2JfZW5kX2NsZWFuKCk7DQoJCQl9IGVsc2Ugew0KCQkJCXRyaWdnZXJfZXJyb3IoIHNwcmludGYoIF9fKCAnVGVtcGxhdGUgZmlsZSBpcyBtaXNzaW5nIGZvciBgJXNgIHNob3J0Y29kZS4gTWFrZSBzdXJlIHlvdSBoYXZlIGAlc2AgZmlsZSBpbiB5b3VyIHRoZW1lIGZvbGRlci4nLCAnanNfY29tcG9zZXInICksICR0aGlzLT5zaG9ydGNvZGUsICd3cC1jb250ZW50L3RoZW1lcy95b3VyX3RoZW1lL3ZjX3RlbXBsYXRlcy8nIC4gJHRoaXMtPnNob3J0Y29kZSAuICcucGhwJyApICk7DQoJCQl9DQoJCQlyZXR1cm4gJG91dHB1dDsNCgkJfQ0KDQoJCXB1YmxpYyBmdW5jdGlvbiBjb250ZW50QWRtaW4oICRhdHRzLCAkY29udGVudCApIHsNCgkJCSRlbGVtZW50ID0gJHRoaXMtPnNob3J0Y29kZTsNCgkJCSRvdXRwdXQgPSAkY3VzdG9tX21hcmt1cCA9ICR3aWR0aCA9ICRlbF9wb3NpdGlvbiA9ICcnOw0KDQoJCQlpZiAoICRjb250ZW50ICE9IE5VTEwgKSB7DQoJCQkJJGNvbnRlbnQgPSB3cGF1dG9wKCBzdHJpcHNsYXNoZXMoICRjb250ZW50ICkgKTsNCgkJCX0NCg0KCQkJaWYgKCBpc3NldCggJHRoaXMtPnNldHRpbmdzWydwYXJhbXMnXSApICkgew0KCQkJCSRzaG9ydGNvZGVfYXR0cmlidXRlcyA9IGFycmF5KCAnd2lkdGgnID0+ICcxLzEnICk7DQoJCQkJZm9yZWFjaCAoICR0aGlzLT5zZXR0aW5nc1sncGFyYW1zJ10gYXMgJHBhcmFtICkgew0KCQkJCQlpZiAoICRwYXJhbVsncGFyYW1fbmFtZSddICE9ICdjb250ZW50JyApIHsNCgkJCQkJCWlmICggaXNzZXQoICRwYXJhbVsndmFsdWUnXSApICkgew0KCQkJCQkJCSRzaG9ydGNvZGVfYXR0cmlidXRlc1skcGFyYW1bJ3BhcmFtX25hbWUnXV0gPSBpc19zdHJpbmcoICRwYXJhbVsndmFsdWUnXSApID8gX18oICRwYXJhbVsndmFsdWUnXSwgImpzX2NvbXBvc2VyIiApIDogJHBhcmFtWyd2YWx1ZSddOw0KCQkJCQkJfSBlbHNlIHsNCgkJCQkJCQkkc2hvcnRjb2RlX2F0dHJpYnV0ZXNbJHBhcmFtWydwYXJhbV9uYW1lJ11dID0gJyc7DQoJCQkJCQl9DQoJCQkJCX0gZWxzZSBpZiAoICRwYXJhbVsncGFyYW1fbmFtZSddID09ICdjb250ZW50JyAmJiAkY29udGVudCA9PSBOVUxMICkgew0KCQkJCQkJJGNvbnRlbnQgPSBpc3NldCggJHBhcmFtWyd2YWx1ZSddICkgPyBfXyggJHBhcmFtWyd2YWx1ZSddLCAianNfY29tcG9zZXIiICkgOiAnJzsNCgkJCQkJfQ0KCQkJCX0NCgkJCQlleHRyYWN0KCBzaG9ydGNvZGVfYXR0cygNCgkJCQkJJHNob3J0Y29kZV9hdHRyaWJ1dGVzDQoJCQkJCSwgJGF0dHMgKSApOw0KCQkJCSRlbGVtID0gJHRoaXMtPmdldEVsZW1lbnRIb2xkZXIoICR3aWR0aCApOw0KCQkJCWlmICggaXNzZXQoICRhdHRzWydlbF9wb3NpdGlvbiddICkgKSAkZWxfcG9zaXRpb24gPSAkYXR0c1snZWxfcG9zaXRpb24nXTsNCgkJCQkkaW5lciA9ICR0aGlzLT5vdXRwdXRUaXRsZSggJHRoaXMtPnNldHRpbmdzWyduYW1lJ10gKTsNCgkJCQlmb3JlYWNoICggJHRoaXMtPnNldHRpbmdzWydwYXJhbXMnXSBhcyAkcGFyYW0gKSB7DQoJCQkJCSRwYXJhbV92YWx1ZSA9IGlzc2V0KCAkJHBhcmFtWydwYXJhbV9uYW1lJ10gKSA/ICQkcGFyYW1bJ3BhcmFtX25hbWUnXSA6ICcnOw0KCQkJCQlpZiAoIGlzX2FycmF5KCAkcGFyYW1fdmFsdWUgKSApIHsNCgkJCQkJCS8vIEdldCBmaXJzdCBlbGVtZW50IGZyb20gdGhlIGFycmF5DQoJCQkJCQlyZXNldCggJHBhcmFtX3ZhbHVlICk7DQoJCQkJCQkkZmlyc3Rfa2V5ID0ga2V5KCAkcGFyYW1fdmFsdWUgKTsNCgkJCQkJCSRwYXJhbV92YWx1ZSA9IGlzX251bGwoICRmaXJzdF9rZXkgKSA/ICcnIDogJHBhcmFtX3ZhbHVlWyRmaXJzdF9rZXldOw0KCQkJCQl9DQoJCQkJCSRpbmVyIC49ICR0aGlzLT5zaW5nbGVQYXJhbUh0bWxIb2xkZXIoICRwYXJhbSwgJHBhcmFtX3ZhbHVlICk7DQoJCQkJfQ0KCQkJCSRlbGVtID0gc3RyX2lyZXBsYWNlKCAnJXdwYl9lbGVtZW50X2NvbnRlbnQlJywgJGluZXIsICRlbGVtICk7DQoJCQkJJG91dHB1dCAuPSAkZWxlbTsNCgkJCX0gZWxzZSB7DQoJCQkJLy9UaGlzIGlzIHVzZWQgZm9yIHNob3J0Y29kZXMgd2l0aG91dCBwYXJhbXMgKGxpa2Ugc2ltcGxlIGRpdmlkZXIpDQoJCQkJLy8gJGNvbHVtbl9jb250cm9scyA9ICR0aGlzLT5nZXRDb2x1bW5Db250cm9scygkdGhpcy0+c2V0dGluZ3NbJ2NvbnRyb2xzJ10pOw0KCQkJCSR3aWR0aCA9ICcxLzEnOw0KDQoJCQkJJGVsZW0gPSAkdGhpcy0+Z2V0RWxlbWVudEhvbGRlciggJHdpZHRoICk7DQoNCgkJCQkkaW5uZXIgPSAnJzsNCgkJCQlpZiAoIGlzc2V0KCAkdGhpcy0+c2V0dGluZ3NbImN1c3RvbV9tYXJrdXAiXSApICYmICR0aGlzLT5zZXR0aW5nc1siY3VzdG9tX21hcmt1cCJdICE9ICcnICkgew0KCQkJCQlpZiAoICRjb250ZW50ICE9ICcnICkgew0KCQkJCQkJJGN1c3RvbV9tYXJrdXAgPSBzdHJfaXJlcGxhY2UoICIlY29udGVudCUiLCAkY29udGVudCwgJHRoaXMtPnNldHRpbmdzWyJjdXN0b21fbWFya3VwIl0gKTsNCgkJCQkJfSBlbHNlIGlmICggJGNvbnRlbnQgPT0gJycgJiYgaXNzZXQoICR0aGlzLT5zZXR0aW5nc1siZGVmYXVsdF9jb250ZW50X2luX3RlbXBsYXRlIl0gKSAmJiAkdGhpcy0+c2V0dGluZ3NbImRlZmF1bHRfY29udGVudF9pbl90ZW1wbGF0ZSJdICE9ICcnICkgew0KCQkJCQkJJGN1c3RvbV9tYXJrdXAgPSBzdHJfaXJlcGxhY2UoICIlY29udGVudCUiLCAkdGhpcy0+c2V0dGluZ3NbImRlZmF1bHRfY29udGVudF9pbl90ZW1wbGF0ZSJdLCAkdGhpcy0+c2V0dGluZ3NbImN1c3RvbV9tYXJrdXAiXSApOw0KCQkJCQl9DQoJCQkJCS8vJG91dHB1dCAuPSBkb19zaG9ydGNvZGUoJHRoaXMtPnNldHRpbmdzWyJjdXN0b21fbWFya3VwIl0pOw0KCQkJCQkkaW5uZXIgLj0gZG9fc2hvcnRjb2RlKCAkY3VzdG9tX21hcmt1cCApOw0KCQkJCX0NCgkJCQkkZWxlbSA9IHN0cl9pcmVwbGFjZSggJyV3cGJfZWxlbWVudF9jb250ZW50JScsICRpbm5lciwgJGVsZW0gKTsNCgkJCQkkb3V0cHV0IC49ICRlbGVtOw0KCQkJfQ0KCQkJcmV0dXJuICRvdXRwdXQ7DQoJCX0NCg0KCQlwdWJsaWMgZnVuY3Rpb24gaXNBZG1pbigpIHsNCgkJCXJldHVybiBpc19hZG1pbigpICYmICEgZW1wdHkoICRfUE9TVFsnYWN0aW9uJ10gKSAmJiBwcmVnX21hdGNoKCAnL153cGJcXy8nLCAkX1BPU1RbJ2FjdGlvbiddICk7DQoJCX0NCg0KCQlwdWJsaWMgZnVuY3Rpb24gaXNJbmxpbmUoKSB7DQoJCQlyZXR1cm4gdmNfaXNfaW5saW5lKCk7DQoJCX0NCg0KCQlwdWJsaWMgZnVuY3Rpb24gaXNFZGl0b3IoKSB7DQoJCQlyZXR1cm4gdmNfaXNfZWRpdG9yKCk7DQoJCX0NCg0KCQlwdWJsaWMgZnVuY3Rpb24gb3V0cHV0KCAkYXR0cywgJGNvbnRlbnQgPSBudWxsLCAkYmFzZSA9ICcnICkgew0KCQkJJHRoaXMtPmF0dHMgPSAkdGhpcy0+cHJlcGFyZUF0dHMoICRhdHRzICk7DQoJCQkkb3V0cHV0ID0gJyc7DQoJCQkkY29udGVudCA9IGVtcHR5KCAkY29udGVudCApICYmICEgZW1wdHkoICRhdHRzWydjb250ZW50J10gKSA/ICRhdHRzWydjb250ZW50J10gOiAkY29udGVudDsNCgkJCWlmICggKCAkdGhpcy0+aXNJbmxpbmUoKSB8fCB2Y19pc19wYWdlX2VkaXRhYmxlKCkgKSAmJiBtZXRob2RfZXhpc3RzKCAkdGhpcywgJ2NvbnRlbnRJbmxpbmUnICkgKSB7DQoJCQkJJG91dHB1dCAuPSAkdGhpcy0+Y29udGVudElubGluZSggJHRoaXMtPmF0dHMsICRjb250ZW50ICk7DQoJCQl9IGVsc2VpZiAoICR0aGlzLT5pc0FkbWluKCkgKSB7DQoJCQkJJG91dHB1dCAuPSAkdGhpcy0+Y29udGVudEFkbWluKCAkdGhpcy0+YXR0cywgJGNvbnRlbnQgKTsNCgkJCX0NCgkJCWlmICggZW1wdHkoICRvdXRwdXQgKSApIHsNCgkJCQkkY3VzdG9tX291dHB1dCA9IFZDX1NIT1JUQ09ERV9DVVNUT01JWkVfUFJFRklYIC4gJHRoaXMtPnNob3J0Y29kZTsNCgkJCQkkY3VzdG9tX291dHB1dF9iZWZvcmUgPSBWQ19TSE9SVENPREVfQkVGT1JFX0NVU1RPTUlaRV9QUkVGSVggLiAkdGhpcy0+c2hvcnRjb2RlOyAvLyBiZWZvcmUgc2hvcnRjb2RlIGZ1bmN0aW9uIGhvb2sNCgkJCQkkY3VzdG9tX291dHB1dF9hZnRlciA9IFZDX1NIT1JUQ09ERV9BRlRFUl9DVVNUT01JWkVfUFJFRklYIC4gJHRoaXMtPnNob3J0Y29kZTsgLy8gYWZ0ZXIgc2hvcnRjb2RlIGZ1bmN0aW9uIGhvb2sNCg0KCQkJCS8vIEJlZm9yZSBzaG9ydGNvZGUNCgkJCQlpZiAoIGZ1bmN0aW9uX2V4aXN0cyggJGN1c3RvbV9vdXRwdXRfYmVmb3JlICkgKSB7DQoJCQkJCSRvdXRwdXQgLj0gJGN1c3RvbV9vdXRwdXRfYmVmb3JlKCAkdGhpcy0+YXR0cywgJGNvbnRlbnQgKTsNCgkJCQl9IGVsc2Ugew0KCQkJCQkkb3V0cHV0IC49ICR0aGlzLT5iZWZvcmVTaG9ydGNvZGUoICR0aGlzLT5hdHRzLCAkY29udGVudCApOw0KCQkJCX0NCgkJCQkvLyBTaG9ydGNvZGUgY29udGVudA0KCQkJCWlmICggZnVuY3Rpb25fZXhpc3RzKCAkY3VzdG9tX291dHB1dCApICkgew0KCQkJCQkkb3V0cHV0IC49ICRjdXN0b21fb3V0cHV0KCAkdGhpcy0+YXR0cywgJGNvbnRlbnQgKTsNCgkJCQl9IGVsc2Ugew0KCQkJCQkkb3V0cHV0IC49ICR0aGlzLT5jb250ZW50KCAkdGhpcy0+YXR0cywgJGNvbnRlbnQgKTsNCgkJCQl9DQoJCQkJLy8gQWZ0ZXIgc2hvcnRjb2RlDQoJCQkJaWYgKCBmdW5jdGlvbl9leGlzdHMoICRjdXN0b21fb3V0cHV0X2FmdGVyICkgKSB7DQoJCQkJCSRvdXRwdXQgLj0gJGN1c3RvbV9vdXRwdXRfYWZ0ZXIoICR0aGlzLT5hdHRzLCAkY29udGVudCApOw0KCQkJCX0gZWxzZSB7DQoJCQkJCSRvdXRwdXQgLj0gJHRoaXMtPmFmdGVyU2hvcnRjb2RlKCAkdGhpcy0+YXR0cywgJGNvbnRlbnQgKTsNCgkJCQl9DQoNCgkJCQkvLyBGaWx0ZXIgZm9yIG92ZXJyaWRpbmcgb3V0cHV0cw0KCQkJCSRvdXRwdXQgPSBhcHBseV9maWx0ZXJzKCAndmNfc2hvcnRjb2RlX291dHB1dCcsICRvdXRwdXQsICR0aGlzICk7DQoJCQl9DQoNCgkJCXJldHVybiAkb3V0cHV0Ow0KCQl9DQoNCgkJLyoqDQoJCSAqIENyZWF0ZXMgaHRtbCBiZWZvcmUgc2hvcnRjb2RlIGh0bWwuDQoJCSAqDQoJCSAqIEBwYXJhbSAkYXR0cyAgICAtIHNob3J0Y29kZSBhdHRyaWJ1dGVzIGxpc3QNCgkJICogQHBhcmFtICRjb250ZW50IC0gc2hvcnRjb2RlIGNvbnRlbnQNCgkJICogQHJldHVybiBzdHJpbmcgLSBodG1sIHdoaWNoIHdpbGwgYmUgZGlzcGxheWVkIGJlZm9yZSBzaG9ydGNvZGUgaHRtbC4NCgkJICovDQoJCXB1YmxpYyBmdW5jdGlvbiBiZWZvcmVTaG9ydGNvZGUoICRhdHRzLCAkY29udGVudCApIHsNCgkJCXJldHVybiAnJzsNCgkJfQ0KDQoJCS8qKg0KCQkgKiBDcmVhdGVzIGh0bWwgYmVmb3JlIHNob3J0Y29kZSBodG1sLg0KCQkgKg0KCQkgKiBAcGFyYW0gJGF0dHMgICAgLSBzaG9ydGNvZGUgYXR0cmlidXRlcyBsaXN0DQoJCSAqIEBwYXJhbSAkY29udGVudCAtIHNob3J0Y29kZSBjb250ZW50DQoJCSAqIEByZXR1cm4gc3RyaW5nIC0gaHRtbCB3aGljaCB3aWxsIGJlIGRpc3BsYXllZCBhZnRlciBzaG9ydGNvZGUgaHRtbC4NCgkJICovDQoJCXB1YmxpYyBmdW5jdGlvbiBhZnRlclNob3J0Y29kZSggJGF0dHMsICRjb250ZW50ICkgew0KCQkJcmV0dXJuICcnOw0KCQl9DQoNCgkJcHVibGljIGZ1bmN0aW9uIGdldEV4dHJhQ2xhc3MoICRlbF9jbGFzcyApIHsNCgkJCSRvdXRwdXQgPSAnJzsNCgkJCWlmICggJGVsX2NsYXNzICE9ICcnICkgew0KCQkJCSRvdXRwdXQgPSAiICIgLiBzdHJfcmVwbGFjZSggIi4iLCAiIiwgJGVsX2NsYXNzICk7DQoJCQl9DQoJCQlyZXR1cm4gJG91dHB1dDsNCgkJfQ0KDQoJCXB1YmxpYyBmdW5jdGlvbiBnZXRDU1NBbmltYXRpb24oICRjc3NfYW5pbWF0aW9uICkgew0KCQkJJG91dHB1dCA9ICcnOw0KCQkJaWYgKCAkY3NzX2FuaW1hdGlvbiAhPSAnJyApIHsNCgkJCQl3cF9lbnF1ZXVlX3NjcmlwdCggJ3dheXBvaW50cycgKTsNCgkJCQkkb3V0cHV0ID0gJyB3cGJfYW5pbWF0ZV93aGVuX2FsbW9zdF92aXNpYmxlIHdwYl8nIC4gJGNzc19hbmltYXRpb247DQoJCQl9DQoJCQlyZXR1cm4gJG91dHB1dDsNCgkJfQ0KDQoJCS8qKg0KCQkgKiBDcmVhdGUgSFRNTCBjb21tZW50IGZvciBibG9ja3MNCgkJICoNCgkJICogQHBhcmFtICRzdHJpbmcNCgkJICoNCgkJICogQHJldHVybiBzdHJpbmcNCgkJICovDQoJCXB1YmxpYyBmdW5jdGlvbiBlbmRCbG9ja0NvbW1lbnQoICRzdHJpbmcgKSB7DQoJCQkvL3JldHVybiAnJzsNCgkJCXJldHVybiAoICEgZW1wdHkoICRfR0VUWyd3cGJfZGVidWcnXSApICYmICRfR0VUWyd3cGJfZGVidWcnXSA9PSAndHJ1ZScgPyAnPCEtLSBFTkQgJyAuICRzdHJpbmcgLiAnIC0tPicgOiAnJyApOw0KCQl9DQoNCgkJLyoqDQoJCSAqIFN0YXJ0IHJvdyBjb21tZW50IGZvciBodG1sIHNob3J0Y29kZSBibG9jaw0KCQkgKg0KCQkgKiBAcGFyYW0gJHBvc2l0aW9uIC0gYmxvY2sgcG9zaXRpb24NCgkJICogQHJldHVybiBzdHJpbmcNCgkJICovDQoJCXB1YmxpYyBmdW5jdGlvbiBzdGFydFJvdyggJHBvc2l0aW9uICkgew0KCQkJJG91dHB1dCA9ICcnOw0KCQkJcmV0dXJuICcnOw0KCQl9DQoNCgkJLyoqDQoJCSAqIEVuZCByb3cgY29tbWVudCBmb3IgaHRtbCBzaG9ydGNvZGUgYmxvY2sNCgkJICoNCgkJICogQHBhcmFtICRwb3NpdGlvbiAtYmxvY2sgcG9zaXRpb24NCgkJICogQHJldHVybiBzdHJpbmcNCgkJICovDQoNCgkJcHVibGljIGZ1bmN0aW9uIGVuZFJvdyggJHBvc2l0aW9uICkgew0KCQkJJG91dHB1dCA9ICcnOw0KCQkJcmV0dXJuICcnOw0KCQl9DQoNCgkJcHVibGljIGZ1bmN0aW9uIHNldHRpbmdzKCAkbmFtZSApIHsNCgkJCXJldHVybiBpc3NldCggJHRoaXMtPnNldHRpbmdzWyRuYW1lXSApID8gJHRoaXMtPnNldHRpbmdzWyRuYW1lXSA6IG51bGw7DQoJCX0NCg0KCQlwdWJsaWMgZnVuY3Rpb24gZ2V0RWxlbWVudEhvbGRlciggJHdpZHRoICkgew0KCQkJJG91dHB1dCA9ICcnOw0KCQkJJGNvbHVtbl9jb250cm9scyA9ICR0aGlzLT5nZXRDb2x1bW5Db250cm9scyggJHRoaXMtPnNldHRpbmdzKCAnY29udHJvbHMnICkgKTsNCgkJCSRjc3NfY2xhc3MgPSAnd3BiXycgLiAkdGhpcy0+c2V0dGluZ3NbImJhc2UiXSAuICcgd3BiX2NvbnRlbnRfZWxlbWVudCB3cGJfc29ydGFibGUnIC4gKCAhIGVtcHR5KCAkdGhpcy0+c2V0dGluZ3NbImNsYXNzIl0gKSA/ICcgJyAuICR0aGlzLT5zZXR0aW5nc1siY2xhc3MiXSA6ICcnICk7DQoJCQkkb3V0cHV0IC49ICc8ZGl2IGRhdGEtZWxlbWVudF90eXBlPSInIC4gJHRoaXMtPnNldHRpbmdzWyJiYXNlIl0gLiAnIiBjbGFzcz0iJyAuICRjc3NfY2xhc3MgLiAnIj4nOw0KCQkJJG91dHB1dCAuPSBzdHJfcmVwbGFjZSggIiVjb2x1bW5fc2l6ZSUiLCB3cGJfdHJhbnNsYXRlQ29sdW1uV2lkdGhUb0ZyYWN0aW9uYWwoICR3aWR0aCApLCAkY29sdW1uX2NvbnRyb2xzICk7DQoJCQkkb3V0cHV0IC49ICR0aGlzLT5nZXRDYWxsYmFja3MoICR0aGlzLT5zaG9ydGNvZGUgKTsNCgkJCSRvdXRwdXQgLj0gJzxkaXYgY2xhc3M9IndwYl9lbGVtZW50X3dyYXBwZXIgJyAuICR0aGlzLT5zZXR0aW5ncyggIndyYXBwZXJfY2xhc3MiICkgLiAnIj4nOw0KCQkJJG91dHB1dCAuPSAnJXdwYl9lbGVtZW50X2NvbnRlbnQlJzsNCgkJCSRvdXRwdXQgLj0gJzwvZGl2Pic7IC8vIDwhLS0gZW5kIC53cGJfZWxlbWVudF93cmFwcGVyIC0tPic7DQoJCQkkb3V0cHV0IC49ICc8L2Rpdj4nOyAvLyA8IS0tIGVuZCAjZWxlbWVudC0nLiR0aGlzLT5zaG9ydGNvZGUuJyAtLT4nOw0KCQkJcmV0dXJuICRvdXRwdXQ7DQoJCX0NCg0KCQkvKiBUaGlzIHJldHVycyBibG9jayBjb250cm9scw0KLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqLw0KCQlwdWJsaWMgZnVuY3Rpb24gZ2V0Q29sdW1uQ29udHJvbHMoICRjb250cm9scywgJGV4dGVuZGVkX2NzcyA9ICcnICkgew0KCQkJJGNvbnRyb2xzX3N0YXJ0ID0gJzxkaXYgY2xhc3M9ImNvbnRyb2xzIGNvbnRyb2xzX2VsZW1lbnQnIC4gKCAhIGVtcHR5KCAkZXh0ZW5kZWRfY3NzICkgPyAiIHskZXh0ZW5kZWRfY3NzfSIgOiAnJyApIC4gJyI+JzsNCgkJCSRjb250cm9sc19lbmQgPSAnPC9kaXY+JzsNCg0KCQkJJGNvbnRyb2xzX2FkZCA9ICcnOyAvLycgPGEgY2xhc3M9ImNvbHVtbl9hZGQiIGhyZWY9IiMiIHRpdGxlPSInLnNwcmludGYoX18oJ0FkZCB0byAlcycsICdqc19jb21wb3NlcicpLCBzdHJ0b2xvd2VyKCR0aGlzLT5zZXR0aW5ncygnbmFtZScpKSkuJyI+PC9hPic7DQoJCQkkY29udHJvbHNfZWRpdCA9ICcgPGEgY2xhc3M9ImNvbHVtbl9lZGl0IiBocmVmPSIjIiB0aXRsZT0iJyAuIHNwcmludGYoIF9fKCAnRWRpdCAlcycsICdqc19jb21wb3NlcicgKSwgc3RydG9sb3dlciggJHRoaXMtPnNldHRpbmdzKCAnbmFtZScgKSApICkgLiAnIj48L2E+JzsNCgkJCSRjb250cm9sc19kZWxldGUgPSAnIDxhIGNsYXNzPSJjb2x1bW5fY2xvbmUiIGhyZWY9IiMiIHRpdGxlPSInIC4gc3ByaW50ZiggX18oICdDbG9uZSAlcycsICdqc19jb21wb3NlcicgKSwgc3RydG9sb3dlciggJHRoaXMtPnNldHRpbmdzKCAnbmFtZScgKSApICkgLiAnIj48L2E+IDxhIGNsYXNzPSJjb2x1bW5fZGVsZXRlIiBocmVmPSIjIiB0aXRsZT0iJyAuIHNwcmludGYoIF9fKCAnRGVsZXRlICVzJywgJ2pzX2NvbXBvc2VyJyApLCBzdHJ0b2xvd2VyKCAkdGhpcy0+c2V0dGluZ3MoICduYW1lJyApICkgKSAuICciPjwvYT4nOw0KDQoJCQkkY29sdW1uX2NvbnRyb2xzX2Z1bGwgPSAkY29udHJvbHNfc3RhcnQgLiAkY29udHJvbHNfYWRkIC4gJGNvbnRyb2xzX2VkaXQgLiAkY29udHJvbHNfZGVsZXRlIC4gJGNvbnRyb2xzX2VuZDsNCgkJCSRjb2x1bW5fY29udHJvbHNfc2l6ZV9kZWxldGUgPSAkY29udHJvbHNfc3RhcnQgLiAkY29udHJvbHNfZGVsZXRlIC4gJGNvbnRyb2xzX2VuZDsNCgkJCSRjb2x1bW5fY29udHJvbHNfcG9wdXBfZGVsZXRlID0gJGNvbnRyb2xzX3N0YXJ0IC4gJGNvbnRyb2xzX2RlbGV0ZSAuICRjb250cm9sc19lbmQ7DQoJCQkkY29sdW1uX2NvbnRyb2xzX2VkaXRfcG9wdXBfZGVsZXRlID0gJGNvbnRyb2xzX3N0YXJ0IC4gJGNvbnRyb2xzX2VkaXQgLiAkY29udHJvbHNfZGVsZXRlIC4gJGNvbnRyb2xzX2VuZDsNCg0KCQkJaWYgKCAkY29udHJvbHMgPT0gJ3BvcHVwX2RlbGV0ZScgKSB7DQoJCQkJcmV0dXJuICRjb2x1bW5fY29udHJvbHNfcG9wdXBfZGVsZXRlOw0KCQkJfSBlbHNlIGlmICggJGNvbnRyb2xzID09ICdlZGl0X3BvcHVwX2RlbGV0ZScgKSB7DQoJCQkJcmV0dXJuICRjb2x1bW5fY29udHJvbHNfZWRpdF9wb3B1cF9kZWxldGU7DQoJCQl9IGVsc2UgaWYgKCAkY29udHJvbHMgPT0gJ3NpemVfZGVsZXRlJyApIHsNCgkJCQlyZXR1cm4gJGNvbHVtbl9jb250cm9sc19zaXplX2RlbGV0ZTsNCgkJCX0gZWxzZSBpZiAoICRjb250cm9scyA9PSAncG9wdXBfZGVsZXRlJyApIHsNCgkJCQlyZXR1cm4gJGNvbHVtbl9jb250cm9sc19wb3B1cF9kZWxldGU7DQoJCQl9IGVsc2UgaWYgKCAkY29udHJvbHMgPT0gJ2FkZCcgKSB7DQoJCQkJcmV0dXJuICRjb250cm9sc19zdGFydCAuICRjb250cm9sc19hZGQgLiAkY29udHJvbHNfZW5kOw0KCQkJfSBlbHNlIHsNCgkJCQlyZXR1cm4gJGNvbHVtbl9jb250cm9sc19mdWxsOw0KCQkJfQ0KCQl9DQoNCgkJLyogVGhpcyB3aWxsIGZpcmUgY2FsbGJhY2tzIGlmIHRoZXkgYXJlIGRlZmluZWQgaW4gbWFwLnBocA0KLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqLw0KCQlwdWJsaWMgZnVuY3Rpb24gZ2V0Q2FsbGJhY2tzKCAkaWQgKSB7DQoJCQkkb3V0cHV0ID0gJyc7DQoNCgkJCWlmICggaXNzZXQoICR0aGlzLT5zZXR0aW5nc1snanNfY2FsbGJhY2snXSApICkgew0KCQkJCWZvcmVhY2ggKCAkdGhpcy0+c2V0dGluZ3NbJ2pzX2NhbGxiYWNrJ10gYXMgJHRleHRfdmFsID0+ICR2YWwgKSB7DQoJCQkJCS8qIFRPRE86IG5hbWUgZXhwbGFpbiAqLw0KCQkJCQkkb3V0cHV0IC49ICc8aW5wdXQgdHlwZT0iaGlkZGVuIiBjbGFzcz0id3BiX3ZjX2NhbGxiYWNrIHdwYl92Y18nIC4gJHRleHRfdmFsIC4gJ19jYWxsYmFjayAiIG5hbWU9IicgLiAkdGV4dF92YWwgLiAnIiB2YWx1ZT0iJyAuICR2YWwgLiAnIiAvPic7DQoJCQkJfQ0KCQkJfQ0KDQoJCQlyZXR1cm4gJG91dHB1dDsNCgkJfQ0KDQoJCXB1YmxpYyBmdW5jdGlvbiBzaW5nbGVQYXJhbUh0bWxIb2xkZXIoICRwYXJhbSwgJHZhbHVlICkgew0KCQkJJG91dHB1dCA9ICcnOw0KCQkJLy8gQ29tcGF0aWJpbGl0eSBmaXhlcw0KCQkJJG9sZF9uYW1lcyA9IGFycmF5KCAneWVsbG93X21lc3NhZ2UnLCAnYmx1ZV9tZXNzYWdlJywgJ2dyZWVuX21lc3NhZ2UnLCAnYnV0dG9uX2dyZWVuJywgJ2J1dHRvbl9ncmV5JywgJ2J1dHRvbl95ZWxsb3cnLCAnYnV0dG9uX2JsdWUnLCAnYnV0dG9uX3JlZCcsICdidXR0b25fb3JhbmdlJyApOw0KCQkJJG5ld19uYW1lcyA9IGFycmF5KCAnYWxlcnQtYmxvY2snLCAnYWxlcnQtaW5mbycsICdhbGVydC1zdWNjZXNzJywgJ2J0bi1zdWNjZXNzJywgJ2J0bicsICdidG4taW5mbycsICdidG4tcHJpbWFyeScsICdidG4tZGFuZ2VyJywgJ2J0bi13YXJuaW5nJyApOw0KCQkJJHZhbHVlID0gc3RyX2lyZXBsYWNlKCAkb2xkX25hbWVzLCAkbmV3X25hbWVzLCAkdmFsdWUgKTsNCgkJCS8vJHZhbHVlID0gX18oJHZhbHVlLCAianNfY29tcG9zZXIiKTsNCgkJCS8vDQoJCQkkcGFyYW1fbmFtZSA9IGlzc2V0KCAkcGFyYW1bJ3BhcmFtX25hbWUnXSApID8gJHBhcmFtWydwYXJhbV9uYW1lJ10gOiAnJzsNCgkJCSR0eXBlID0gaXNzZXQoICRwYXJhbVsndHlwZSddICkgPyAkcGFyYW1bJ3R5cGUnXSA6ICcnOw0KCQkJJGNsYXNzID0gaXNzZXQoICRwYXJhbVsnY2xhc3MnXSApID8gJHBhcmFtWydjbGFzcyddIDogJyc7DQoJCQlpZiAoICEgZW1wdHkoICRwYXJhbVsnaG9sZGVyJ10gKSApIHsNCgkJCQlpZiAoICRwYXJhbVsnaG9sZGVyJ10gIT09ICdoaWRkZW4nICkgew0KCQkJCQkkb3V0cHV0IC49ICc8JyAuICRwYXJhbVsnaG9sZGVyJ10gLiAnIGNsYXNzPSJ3cGJfdmNfcGFyYW1fdmFsdWUgJyAuICRwYXJhbV9uYW1lIC4gJyAnIC4gJHR5cGUgLiAnICcgLiAkY2xhc3MgLiAnIiBuYW1lPSInIC4gJHBhcmFtX25hbWUgLiAnIj4nIC4gJHZhbHVlIC4gJzwvJyAuICRwYXJhbVsnaG9sZGVyJ10gLiAnPic7DQoJCQkJfSBlbHNlaWYgKCAkcGFyYW1bJ2hvbGRlciddID09ICdpbnB1dCcgKSB7DQoJCQkJCSRvdXRwdXQgLj0gJzwnIC4gJHBhcmFtWydob2xkZXInXSAuICcgcmVhZG9ubHk9InRydWUiIGNsYXNzPSJ3cGJfdmNfcGFyYW1fdmFsdWUgJyAuICRwYXJhbV9uYW1lIC4gJyAnIC4gJHR5cGUgLiAnICcgLiAkY2xhc3MgLiAnIiBuYW1lPSInIC4gJHBhcmFtX25hbWUgLiAnIiB2YWx1ZT0iJyAuICR2YWx1ZSAuICciPic7DQoJCQkJfSBlbHNlaWYgKCBpbl9hcnJheSggJHBhcmFtWydob2xkZXInXSwgYXJyYXkoICdpbWcnLCAnaWZyYW1lJyApICkgKSB7DQoJCQkJCSRvdXRwdXQgLj0gJzwnIC4gJHBhcmFtWydob2xkZXInXSAuICcgY2xhc3M9IndwYl92Y19wYXJhbV92YWx1ZSAnIC4gJHBhcmFtX25hbWUgLiAnICcgLiAkdHlwZSAuICcgJyAuICRjbGFzcyAuICciIG5hbWU9IicgLiAkcGFyYW1fbmFtZSAuICciIHNyYz0iJyAuICR2YWx1ZSAuICciPic7DQoJCQkJfQ0KCQkJfQ0KCQkJaWYgKCAhIGVtcHR5KCAkcGFyYW1bJ2FkbWluX2xhYmVsJ10gKSAmJiAkcGFyYW1bJ2FkbWluX2xhYmVsJ10gPT09IHRydWUgKSB7DQoJCQkJJG91dHB1dCAuPSAnPHNwYW4gY2xhc3M9InZjX2FkbWluX2xhYmVsIGFkbWluX2xhYmVsXycgLiAkcGFyYW1bJ3BhcmFtX25hbWUnXSAuICggZW1wdHkoICR2YWx1ZSApID8gJyBoaWRkZW4tbGFiZWwnIDogJycgKSAuICciPjxsYWJlbD4nIC4gX18oICRwYXJhbVsnaGVhZGluZyddLCAnanNfY29tcG9zZXInICkgLiAnPC9sYWJlbD46ICcgLiAkdmFsdWUgLiAnPC9zcGFuPic7DQoJCQl9DQoNCgkJCXJldHVybiAkb3V0cHV0Ow0KCQl9DQoNCgkJcHJvdGVjdGVkIGZ1bmN0aW9uIG91dHB1dFRpdGxlKCAkdGl0bGUgKSB7DQoJCQlyZXR1cm4gJzxoNCBjbGFzcz0id3BiX2VsZW1lbnRfdGl0bGUiPicgLiBfXyggJHRpdGxlLCAnanNfY29tcG9zZXInICkgLiAnPC9oND4nOw0KCQl9DQoNCgkJcHVibGljIGZ1bmN0aW9uIHRlbXBsYXRlKCAkY29udGVudCA9ICcnICkgew0KCQkJcmV0dXJuICR0aGlzLT5jb250ZW50QWRtaW4oICR0aGlzLT5hdHRzLCAkY29udGVudCApOw0KCQl9DQoNCgkJcHJvdGVjdGVkIGZ1bmN0aW9uIHByZXBhcmVBdHRzKCAkYXR0cyApIHsNCgkJCSRyZXR1cm4gPSBhcnJheSgpOw0KCQkJaWYgKCBpc19hcnJheSggJGF0dHMgKSApIHsNCgkJCQlmb3JlYWNoICggJGF0dHMgYXMgJGtleSA9PiAkdmFsICkgew0KCQkJCQkkcmV0dXJuWyRrZXldID0gcHJlZ19yZXBsYWNlKCAnL1xgXGAvJywgJyInLCAkdmFsICk7DQoJCQkJfQ0KCQkJfQ0KCQkJcmV0dXJuICRyZXR1cm47DQoJCX0NCgl9DQp9DQppZiAoICEgY2xhc3NfZXhpc3RzKCAnV1BCYWtlcnlTaG9ydENvZGVfVW5pdmVyc2FsQWRtaW4nICkgKSB7DQoJYWJzdHJhY3QgY2xhc3MgV1BCYWtlcnlTaG9ydENvZGVfVW5pdmVyc2FsQWRtaW4gZXh0ZW5kcyBXUEJha2VyeVNob3J0Q29kZSB7DQoJCXByb3RlY3RlZCAkaHRtbF9lZGl0b3JfYWxyZWFkeV9pc191c2VkID0gZmFsc2U7DQoNCgkJcHVibGljIGZ1bmN0aW9uIF9fY29uc3RydWN0KCAkc2V0dGluZ3MgKSB7DQoJCQkkdGhpcy0+c2V0dGluZ3MgPSAkc2V0dGluZ3M7DQoJCQkkdGhpcy0+YWRkU2hvcnRDb2RlKCAkdGhpcy0+c2V0dGluZ3NbJ2Jhc2UnXSwgQXJyYXkoICR0aGlzLCAnb3V0cHV0JyApICk7DQoJCX0NCg0KCQlwcm90ZWN0ZWQgZnVuY3Rpb24gY29udGVudCggJGF0dHMsICRjb250ZW50ID0gbnVsbCApIHsNCgkJCXJldHVybiAnJzsNCgkJfQ0KDQoJCXB1YmxpYyBmdW5jdGlvbiBjb250ZW50QWRtaW4oICRhdHRzLCAkY29udGVudCApIHsNCg0KCQkJJG91dHB1dCA9ICcnOw0KCQkJJHRoaXMtPmxvYWRQYXJhbXMoKTsNCgkJCS8vaWYgKCAkY29udGVudCAhPSBOVUxMICkgeyAkY29udGVudCA9IGFwcGx5X2ZpbHRlcnMoJ3RoZV9jb250ZW50JywgJGNvbnRlbnQpOyB9DQoJCQkkY29udGVudCA9ICRlbF9wb3NpdGlvbiA9ICcnOw0KCQkJaWYgKCBpc3NldCggJHRoaXMtPnNldHRpbmdzWydwYXJhbXMnXSApICkgew0KCQkJCSRzaG9ydGNvZGVfYXR0cmlidXRlcyA9IGFycmF5KCk7DQoJCQkJZm9yZWFjaCAoICR0aGlzLT5zZXR0aW5nc1sncGFyYW1zJ10gYXMgJHBhcmFtICkgew0KCQkJCQlpZiAoICRwYXJhbVsncGFyYW1fbmFtZSddICE9ICdjb250ZW50JyApIHsNCgkJCQkJCSRzaG9ydGNvZGVfYXR0cmlidXRlc1skcGFyYW1bJ3BhcmFtX25hbWUnXV0gPSAkcGFyYW1bJ3ZhbHVlJ107DQoJCQkJCX0gZWxzZSBpZiAoICRwYXJhbVsncGFyYW1fbmFtZSddID09ICdjb250ZW50JyAmJiAkY29udGVudCA9PT0gbnVsbCApIHsNCgkJCQkJCSRjb250ZW50ID0gJHBhcmFtWyd2YWx1ZSddOw0KCQkJCQl9DQoJCQkJfQ0KCQkJCWV4dHJhY3QoIHNob3J0Y29kZV9hdHRzKA0KCQkJCQkkc2hvcnRjb2RlX2F0dHJpYnV0ZXMNCgkJCQkJLCAkYXR0cyApICk7DQoJCQkJJGVkaXRvcl9jc3NfY2xhc3NlcyA9IGFwcGx5X2ZpbHRlcnMoICd2Y19lZGl0X2Zvcm1fY2xhc3MnLCBhcnJheSggJ3ZjX3NwYW4xMmEnLCAnd3BiX2VkaXRfZm9ybV9lbGVtZW50cycgKSApOw0KCQkJCSRvdXRwdXQgLj0gJzxkaXYgY2xhc3M9IicgLiBpbXBsb2RlKCAnICcsICRlZGl0b3JfY3NzX2NsYXNzZXMgKSAuICciPjxoMj4nIC4gX18oICdFZGl0JywgJ2pzX2NvbXBvc2VyJyApIC4gJyAnIC4gX18oICR0aGlzLT5zZXR0aW5nc1snbmFtZSddLCAianNfY29tcG9zZXIiICkgLiAnPC9oMj4nOw0KDQoJCQkJZm9yZWFjaCAoICR0aGlzLT5zZXR0aW5nc1sncGFyYW1zJ10gYXMgJHBhcmFtICkgew0KCQkJCQkkcGFyYW1fdmFsdWUgPSBpc3NldCggJCRwYXJhbVsncGFyYW1fbmFtZSddICkgPyAkJHBhcmFtWydwYXJhbV9uYW1lJ10gOiBudWxsOw0KCQkJCQlpZiAoIGlzX2FycmF5KCAkcGFyYW1fdmFsdWUgKSAmJiAhIGVtcHR5KCAkcGFyYW1bJ3R5cGUnXSApICYmICRwYXJhbVsndHlwZSddICE9ICdjaGVja2JveCcgKSB7DQoJCQkJCQkvLyBHZXQgZmlyc3QgZWxlbWVudCBmcm9tIHRoZSBhcnJheQ0KCQkJCQkJcmVzZXQoICRwYXJhbV92YWx1ZSApOw0KCQkJCQkJJGZpcnN0X2tleSA9IGtleSggJHBhcmFtX3ZhbHVlICk7DQoJCQkJCQkkcGFyYW1fdmFsdWUgPSAkcGFyYW1fdmFsdWVbJGZpcnN0X2tleV07DQoJCQkJCX0NCgkJCQkJJG91dHB1dCAuPSAkdGhpcy0+c2luZ2xlUGFyYW1FZGl0SG9sZGVyKCAkcGFyYW0sICRwYXJhbV92YWx1ZSApOw0KCQkJCX0NCg0KDQoJCQkJJG91dHB1dCAuPSAnPGRpdiBjbGFzcz0iZWRpdF9mb3JtX2FjdGlvbnMiPjxhIGhyZWY9IiMiIGNsYXNzPSJ3cGJfc2F2ZV9lZGl0X2Zvcm0gYnV0dG9uLXByaW1hcnkiPicgLiBfXyggJ1NhdmUnLCAianNfY29tcG9zZXIiICkgLiAnPC9hPjwvZGl2Pic7DQoNCgkJCQkkb3V0cHV0IC49ICc8L2Rpdj4nOyAvL2Nsb3NlIHdwYl9lZGl0X2Zvcm1fZWxlbWVudHMNCgkJCX0NCgkJCXJldHVybiAkb3V0cHV0Ow0KCQl9DQoNCgkJcHJvdGVjdGVkIGZ1bmN0aW9uIHNpbmdsZVBhcmFtRWRpdEhvbGRlciggJHBhcmFtLCAkcGFyYW1fdmFsdWUgKSB7DQoJCQkkcGFyYW1bJ3ZjX3NpbmdsZV9wYXJhbV9lZGl0X2hvbGRlcl9jbGFzcyddID0gYXJyYXkoICd2Y19yb3ctZmx1aWQnLCAnd3BiX2VsX3R5cGVfJyAuICRwYXJhbVsndHlwZSddLCAndmMtc2hvcnRjb2RlLXBhcmFtJyApOw0KCQkJaWYgKCAhIGVtcHR5KCAkcGFyYW1bJ3BhcmFtX2hvbGRlcl9jbGFzcyddICkgKSAkcGFyYW1bJ3ZjX3NpbmdsZV9wYXJhbV9lZGl0X2hvbGRlcl9jbGFzcyddW10gPSAkcGFyYW1bJ3BhcmFtX2hvbGRlcl9jbGFzcyddOw0KCQkJJHBhcmFtID0gYXBwbHlfZmlsdGVycyggJ3ZjX3NpbmdsZV9wYXJhbV9lZGl0JywgJHBhcmFtICk7DQoJCQkkb3V0cHV0ID0gJzxkaXYgY2xhc3M9IicgLiBpbXBsb2RlKCAnICcsICRwYXJhbVsndmNfc2luZ2xlX3BhcmFtX2VkaXRfaG9sZGVyX2NsYXNzJ10gKSAuICciPic7DQoJCQkkb3V0cHV0IC49ICggaXNzZXQoICRwYXJhbVsnaGVhZGluZyddICkgKSA/ICc8ZGl2IGNsYXNzPSJ3cGJfZWxlbWVudF9sYWJlbCI+JyAuIF9fKCAkcGFyYW1bJ2hlYWRpbmcnXSwgImpzX2NvbXBvc2VyIiApIC4gJzwvZGl2PicgOiAnJzsgLy92Y19zcGFuMw0KDQoJCQkkb3V0cHV0IC49ICc8ZGl2IGNsYXNzPSJlZGl0X2Zvcm1fbGluZSI+JzsgLy92Y19zcGFuOQ0KCQkJJG91dHB1dCAuPSAkdGhpcy0+c2luZ2xlUGFyYW1FZGl0Rm9ybSggJHBhcmFtLCAkcGFyYW1fdmFsdWUgKTsNCgkJCSRvdXRwdXQgLj0gKCBpc3NldCggJHBhcmFtWydkZXNjcmlwdGlvbiddICkgKSA/ICc8c3BhbiBjbGFzcz0iZGVzY3JpcHRpb24gY2xlYXIiPicgLiBfXyggJHBhcmFtWydkZXNjcmlwdGlvbiddLCAianNfY29tcG9zZXIiICkgLiAnPC9zcGFuPicgOiAnJzsNCgkJCSRvdXRwdXQgLj0gJzwvZGl2Pic7DQoNCgkJCSRvdXRwdXQgLj0gJzwvZGl2Pic7DQoNCgkJCXJldHVybiAkb3V0cHV0Ow0KCQl9DQoNCgkJcHJvdGVjdGVkIGZ1bmN0aW9uIHNpbmdsZVBhcmFtRWRpdEZvcm0oICRwYXJhbSwgJHBhcmFtX3ZhbHVlICkgew0KDQoJCQkkcGFyYW1fbGluZSA9ICcnOw0KCQkJLy8gVGV4dGZpZWxkIC0gaW5wdXQNCgkJCWlmICggJHBhcmFtWyd0eXBlJ10gPT0gJ3RleHRmaWVsZCcgKSB7DQoJCQkJJHZhbHVlID0gX18oICRwYXJhbV92YWx1ZSwgImpzX2NvbXBvc2VyIiApOw0KCQkJCSR2YWx1ZSA9IGh0bWxzcGVjaWFsY2hhcnMoICR2YWx1ZSApOw0KCQkJCS8vJHZhbHVlID0gJHBhcmFtX3ZhbHVlOw0KCQkJCSRwYXJhbV9saW5lIC49ICc8aW5wdXQgbmFtZT0iJyAuICRwYXJhbVsncGFyYW1fbmFtZSddIC4gJyIgY2xhc3M9IndwYl92Y19wYXJhbV92YWx1ZSB3cGItdGV4dGlucHV0ICcgLiAkcGFyYW1bJ3BhcmFtX25hbWUnXSAuICcgJyAuICRwYXJhbVsndHlwZSddIC4gJyIgdHlwZT0idGV4dCIgdmFsdWU9IicgLiAkdmFsdWUgLiAnIi8+JzsNCgkJCX0gLy8gRHJvcGRvd24gLSBzZWxlY3QNCgkJCWVsc2UgaWYgKCAkcGFyYW1bJ3R5cGUnXSA9PSAnZHJvcGRvd24nICkgew0KCQkJCSRjc3Nfb3B0aW9uID0gdmNfZ2V0X2Ryb3Bkb3duX29wdGlvbiggJHBhcmFtLCAkcGFyYW1fdmFsdWUgKTsNCgkJCQkkcGFyYW1fbGluZSAuPSAnPHNlbGVjdCBuYW1lPSInIC4gJHBhcmFtWydwYXJhbV9uYW1lJ10gLiAnIiBjbGFzcz0id3BiX3ZjX3BhcmFtX3ZhbHVlIHdwYi1pbnB1dCB3cGItc2VsZWN0ICcgLiAkcGFyYW1bJ3BhcmFtX25hbWUnXSAuICcgJyAuICRwYXJhbVsndHlwZSddIC4gJyAnIC4gJGNzc19vcHRpb24gLiAnIiBkYXRhLW9wdGlvbj0iJyAuICRjc3Nfb3B0aW9uIC4gJyI+JzsNCgkJCQlmb3JlYWNoICggJHBhcmFtWyd2YWx1ZSddIGFzICR0ZXh0X3ZhbCA9PiAkdmFsICkgew0KCQkJCQlpZiAoIGlzX251bWVyaWMoICR0ZXh0X3ZhbCApICYmICggaXNfc3RyaW5nKCAkdmFsICkgfHwgaXNfbnVtZXJpYyggJHZhbCApICkgKSB7DQoJCQkJCQkkdGV4dF92YWwgPSAkdmFsOw0KCQkJCQl9DQoJCQkJCSR0ZXh0X3ZhbCA9IF9fKCAkdGV4dF92YWwsICJqc19jb21wb3NlciIgKTsNCgkJCQkJLy8kdmFsID0gc3RydG9sb3dlcihzdHJfcmVwbGFjZShhcnJheSgiICIpLCBhcnJheSgiXyIpLCAkdmFsKSk7DQoJCQkJCS8vJHZhbCA9IHN0cnRvbG93ZXIoc3RyX3JlcGxhY2UoYXJyYXkoIiAiKSwgYXJyYXkoIl8iKSwgJHZhbCkpOyAvL2lzc3VlICM0NjQgZ2l0aHViDQoJCQkJCSRzZWxlY3RlZCA9ICcnOw0KCQkJCQlpZiAoICRwYXJhbV92YWx1ZSAhPT0gJycgJiYgKHN0cmluZykkdmFsID09PSAoc3RyaW5nKSRwYXJhbV92YWx1ZSApIHsNCgkJCQkJCSRzZWxlY3RlZCA9ICcgc2VsZWN0ZWQ9InNlbGVjdGVkIic7DQoJCQkJCX0NCgkJCQkJJHBhcmFtX2xpbmUgLj0gJzxvcHRpb24gY2xhc3M9IicgLiAkdmFsIC4gJyIgdmFsdWU9IicgLiAkdmFsIC4gJyInIC4gJHNlbGVjdGVkIC4gJz4nIC4gaHRtbHNwZWNpYWxjaGFycyggJHRleHRfdmFsICkgLiAnPC9vcHRpb24+JzsNCgkJCQl9DQoJCQkJJHBhcmFtX2xpbmUgLj0gJzwvc2VsZWN0Pic7DQoJCQl9IC8vIFdZU0lXWUcgZmllbGQNCgkJCWVsc2UgaWYgKCAkcGFyYW1bJ3R5cGUnXSA9PSAndGV4dGFyZWFfaHRtbCcgKSB7DQoJCQkJaWYgKCAkdGhpcy0+aHRtbF9lZGl0b3JfYWxyZWFkeV9pc191c2VkICE9PSBmYWxzZSApIHsNCgkJCQkJJHBhcmFtX3ZhbHVlID0gX18oICRwYXJhbV92YWx1ZSwgImpzX2NvbXBvc2VyIiApOw0KCQkJCQkkcGFyYW1fbGluZSAuPSAnPHRleHRhcmVhIG5hbWU9IicgLiAkcGFyYW1bJ3BhcmFtX25hbWUnXSAuICciIGNsYXNzPSJ3cGJfdmNfcGFyYW1fdmFsdWUgd3BiLXRleHRhcmVhICcgLiAkcGFyYW1bJ3BhcmFtX25hbWUnXSAuICcgdGV4dGFyZWEiPicgLiAkcGFyYW1fdmFsdWUgLiAnPC90ZXh0YXJlYT4nOw0KCQkJCQkkcGFyYW1fbGluZSAuPSAnPGRpdiBjbGFzcz0idXBkYXRlZCI+PHA+JyAuIF9fKCAnRmllbGQgdHlwZSBpcyBjaGFuZ2VkIGZyb20gYHRleHRhcmVhX2h0bWxgIHRvIGB0ZXh0YXJlYWAsIGJlY2F1c2UgaXQgaXMgYWxyZWFkeSB1c2VkIGJ5IGAnIC4gJHRoaXMtPmh0bWxfZWRpdG9yX2FscmVhZHlfaXNfdXNlZCAuICdgIGZpZWxkLiBUZXh0YXJlYV9odG1sIGZpZWxkXCdzIHR5cGUgY2FuIGJlIHVzZWQgb25seSBvbmNlIHBlciBzaG9ydGNvZGUuJywgJ2pzX2NvbXBvc2VyJyApIC4gJzwvcD48L2Rpdj4nOw0KCQkJCX0gZWxzZSB7DQoJCQkJCSR0aGlzLT5odG1sX2VkaXRvcl9hbHJlYWR5X2lzX3VzZWQgPSAkcGFyYW1bJ3BhcmFtX25hbWUnXTsNCgkJCQkJJHBhcmFtX2xpbmUgLj0gZG9fc2hvcnRjb2RlX3BhcmFtX3NldHRpbmdzX2ZpZWxkKCAndGV4dGFyZWFfaHRtbCcsICRwYXJhbSwgJHBhcmFtX3ZhbHVlICk7DQoJCQkJfQ0KCQkJCS8vICRwYXJhbV9saW5lIC49ICR0aGlzLT5nZXRUaW55SHRtbFRleHRBcmVhKCRwYXJhbSwgJHBhcmFtX3ZhbHVlKTsNCgkJCX0gLy8gQ2hlY2tib3hlcyB3aXRoIHBvc3QgdHlwZXMNCgkJCWVsc2UgaWYgKCAkcGFyYW1bJ3R5cGUnXSA9PSAnY2hlY2tib3gnICkgew0KCQkJCS8vIHBhcmFtX2xpbmUgLj0gJzxpbnB1dCBjbGFzcz0id3BiX3ZjX3BhcmFtX3ZhbHVlIHdwYi1jaGVja2JveGVzIiB0eXBlPSJoaWRkZW4iIHZhbHVlPSIiIG5hbWU9IicuJHBhcmFtWydwYXJhbV9uYW1lJ10uJyIvPic7DQoJCQkJJGN1cnJlbnRfdmFsdWUgPSBleHBsb2RlKCAiLCIsICRwYXJhbV92YWx1ZSApOw0KCQkJCSR2YWx1ZXMgPSBpc19hcnJheSggJHBhcmFtWyd2YWx1ZSddICkgPyAkcGFyYW1bJ3ZhbHVlJ10gOiBhcnJheSgpOw0KCQkJCWZvcmVhY2ggKCAkdmFsdWVzIGFzICRsYWJlbCA9PiAkdiApIHsNCgkJCQkJJGNoZWNrZWQgPSBpbl9hcnJheSggJHYsICRjdXJyZW50X3ZhbHVlICkgPyAnIGNoZWNrZWQ9ImNoZWNrZWQiJyA6ICcnOw0KCQkJCQkkcGFyYW1fbGluZSAuPSAnIDxpbnB1dCBpZD0iJyAuICRwYXJhbVsncGFyYW1fbmFtZSddIC4gJy0nIC4gJHYgLiAnIiB2YWx1ZT0iJyAuICR2IC4gJyIgY2xhc3M9IndwYl92Y19wYXJhbV92YWx1ZSAnIC4gJHBhcmFtWydwYXJhbV9uYW1lJ10gLiAnICcgLiAkcGFyYW1bJ3R5cGUnXSAuICciIHR5cGU9ImNoZWNrYm94IiBuYW1lPSInIC4gJHBhcmFtWydwYXJhbV9uYW1lJ10gLiAnIicgLiAkY2hlY2tlZCAuICc+ICcgLiBfXyggJGxhYmVsLCAianNfY29tcG9zZXIiICk7DQoJCQkJfQ0KCQkJfSBlbHNlIGlmICggJHBhcmFtWyd0eXBlJ10gPT0gJ3Bvc3R0eXBlcycgKSB7DQoJCQkJLy8gJHBhcmFtX2xpbmUgLj0gJzxpbnB1dCBjbGFzcz0id3BiX3ZjX3BhcmFtX3ZhbHVlIHdwYi1jaGVja2JveGVzIiB0eXBlPSJoaWRkZW4iIHZhbHVlPSIiIG5hbWU9IicuJHBhcmFtWydwYXJhbV9uYW1lJ10uJyIvPic7DQoJCQkJJGFyZ3MgPSBhcnJheSgNCgkJCQkJJ3B1YmxpYycgPT4gdHJ1ZQ0KCQkJCSk7DQoJCQkJJHBvc3RfdHlwZXMgPSBnZXRfcG9zdF90eXBlcyggJGFyZ3MgKTsNCgkJCQlmb3JlYWNoICggJHBvc3RfdHlwZXMgYXMgJHBvc3RfdHlwZSApIHsNCgkJCQkJJGNoZWNrZWQgPSAiIjsNCgkJCQkJaWYgKCAkcG9zdF90eXBlICE9ICdhdHRhY2htZW50JyApIHsNCgkJCQkJCWlmICggaW5fYXJyYXkoICRwb3N0X3R5cGUsIGV4cGxvZGUoICIsIiwgJHBhcmFtX3ZhbHVlICkgKSApICRjaGVja2VkID0gJyBjaGVja2VkPSJjaGVja2VkIic7DQoJCQkJCQkkcGFyYW1fbGluZSAuPSAnIDxpbnB1dCBpZD0iJyAuICRwYXJhbVsncGFyYW1fbmFtZSddIC4gJy0nIC4gJHBvc3RfdHlwZSAuICciIHZhbHVlPSInIC4gJHBvc3RfdHlwZSAuICciIGNsYXNzPSJ3cGJfdmNfcGFyYW1fdmFsdWUgJyAuICRwYXJhbVsncGFyYW1fbmFtZSddIC4gJyAnIC4gJHBhcmFtWyd0eXBlJ10gLiAnIiB0eXBlPSJjaGVja2JveCIgbmFtZT0iJyAuICRwYXJhbVsncGFyYW1fbmFtZSddIC4gJyInIC4gJGNoZWNrZWQgLiAnPiAnIC4gJHBvc3RfdHlwZTsNCgkJCQkJfQ0KCQkJCX0NCgkJCX0gZWxzZSBpZiAoICRwYXJhbVsndHlwZSddID09ICd0YXhvbm9taWVzJyB8fCAkcGFyYW1bJ3R5cGUnXSA9PSAndGF4b21vbmllcycgKSB7DQoJCQkJLy8gJHBhcmFtX2xpbmUgLj0gJzxpbnB1dCBjbGFzcz0id3BiX3ZjX3BhcmFtX3ZhbHVlIHdwYi1jaGVja2JveGVzIiB0eXBlPSJoaWRkZW4iIHZhbHVlPSIiIG5hbWU9IiIvPic7DQoJCQkJJHBvc3RfdHlwZXMgPSBnZXRfcG9zdF90eXBlcyggYXJyYXkoICdwdWJsaWMnID0+IGZhbHNlLCAnbmFtZScgPT4gJ2F0dGFjaG1lbnQnICksICduYW1lcycsICdOT1QnICk7DQoJCQkJZm9yZWFjaCAoICRwb3N0X3R5cGVzIGFzICR0eXBlICkgew0KCQkJCQkkdGF4b25vbWllcyA9IGdldF9vYmplY3RfdGF4b25vbWllcyggJHR5cGUsICcnICk7DQoJCQkJCWZvcmVhY2ggKCAkdGF4b25vbWllcyBhcyAkdGF4ICkgew0KCQkJCQkJJGNoZWNrZWQgPSAiIjsNCgkJCQkJCWlmICggaW5fYXJyYXkoICR0YXgtPm5hbWUsIGV4cGxvZGUoICIsIiwgJHBhcmFtX3ZhbHVlICkgKSApICRjaGVja2VkID0gJyBjaGVja2VkPSJjaGVja2VkIic7DQoJCQkJCQkkcGFyYW1fbGluZSAuPSAnIDxsYWJlbCBkYXRhLXBvc3QtdHlwZT0iJyAuICR0eXBlIC4gJyI+PGlucHV0IGlkPSInIC4gJHBhcmFtWydwYXJhbV9uYW1lJ10gLiAnLScgLiAkdGF4LT5uYW1lIC4gJyIgdmFsdWU9IicgLiAkdGF4LT5uYW1lIC4gJyIgZGF0YS1wb3N0LXR5cGU9IicgLiAkdHlwZSAuICciIGNsYXNzPSJ3cGJfdmNfcGFyYW1fdmFsdWUgJyAuICRwYXJhbVsncGFyYW1fbmFtZSddIC4gJyAnIC4gJHBhcmFtWyd0eXBlJ10gLiAnIiB0eXBlPSJjaGVja2JveCIgbmFtZT0iJyAuICRwYXJhbVsncGFyYW1fbmFtZSddIC4gJyInIC4gJGNoZWNrZWQgLiAnPiAnIC4gJHRheC0+bGFiZWwgLiAnPC9sYWJlbD4nOw0KCQkJCQl9DQoJCQkJfQ0KCQkJfSAvLyBFeHBsb2RlZCB0ZXh0YXJlYQ0KCQkJZWxzZSBpZiAoICRwYXJhbVsndHlwZSddID09ICdleHBsb2RlZF90ZXh0YXJlYScgKSB7DQoJCQkJJHBhcmFtX3ZhbHVlID0gc3RyX3JlcGxhY2UoICIsIiwgIlxuIiwgJHBhcmFtX3ZhbHVlICk7DQoJCQkJJHBhcmFtX2xpbmUgLj0gJzx0ZXh0YXJlYSBuYW1lPSInIC4gJHBhcmFtWydwYXJhbV9uYW1lJ10gLiAnIiBjbGFzcz0id3BiX3ZjX3BhcmFtX3ZhbHVlIHdwYi10ZXh0YXJlYSAnIC4gJHBhcmFtWydwYXJhbV9uYW1lJ10gLiAnICcgLiAkcGFyYW1bJ3R5cGUnXSAuICciPicgLiAkcGFyYW1fdmFsdWUgLiAnPC90ZXh0YXJlYT4nOw0KCQkJfSAvLyBCaWcgUmVndWxhciB0ZXh0YXJlYQ0KCQkJZWxzZSBpZiAoICRwYXJhbVsndHlwZSddID09ICd0ZXh0YXJlYV9yYXdfaHRtbCcgKSB7DQoJCQkJLy8gJHBhcmFtX3ZhbHVlID0gX18oJHBhcmFtX3ZhbHVlLCAianNfY29tcG9zZXIiKTsNCgkJCQkkcGFyYW1fbGluZSAuPSAnPHRleHRhcmVhIG5hbWU9IicgLiAkcGFyYW1bJ3BhcmFtX25hbWUnXSAuICciIGNsYXNzPSJ3cGJfdmNfcGFyYW1fdmFsdWUgd3BiLXRleHRhcmVhX3Jhd19odG1sICcgLiAkcGFyYW1bJ3BhcmFtX25hbWUnXSAuICcgJyAuICRwYXJhbVsndHlwZSddIC4gJyIgcm93cz0iMTYiPicgLiBodG1sZW50aXRpZXMoIHJhd3VybGRlY29kZSggYmFzZTY0X2RlY29kZSggJHBhcmFtX3ZhbHVlICkgKSwgRU5UX0NPTVBBVCwgJ1VURi04JyApIC4gJzwvdGV4dGFyZWE+JzsNCgkJCX0gLy8gQmlnIFJlZ3VsYXIgdGV4dGFyZWENCgkJCWVsc2UgaWYgKCAkcGFyYW1bJ3R5cGUnXSA9PSAndGV4dGFyZWFfc2FmZScgKSB7DQoJCQkJLy8gJHBhcmFtX3ZhbHVlID0gX18oJHBhcmFtX3ZhbHVlLCAianNfY29tcG9zZXIiKTsNCgkJCQkkcGFyYW1fbGluZSAuPSAnPHRleHRhcmVhIG5hbWU9IicgLiAkcGFyYW1bJ3BhcmFtX25hbWUnXSAuICciIGNsYXNzPSJ3cGJfdmNfcGFyYW1fdmFsdWUgd3BiLXRleHRhcmVhX3Jhd19odG1sICcgLiAkcGFyYW1bJ3BhcmFtX25hbWUnXSAuICcgJyAuICRwYXJhbVsndHlwZSddIC4gJyI+JyAuIHZjX3ZhbHVlX2Zyb21fc2FmZSggJHBhcmFtX3ZhbHVlLCB0cnVlICkgLiAnPC90ZXh0YXJlYT4nOw0KCQkJfSAvLyBSZWd1bGFyIHRleHRhcmVhDQoJCQllbHNlIGlmICggJHBhcmFtWyd0eXBlJ10gPT0gJ3RleHRhcmVhJyApIHsNCgkJCQkkcGFyYW1fdmFsdWUgPSBfXyggJHBhcmFtX3ZhbHVlLCAianNfY29tcG9zZXIiICk7DQoJCQkJJHBhcmFtX2xpbmUgLj0gJzx0ZXh0YXJlYSBuYW1lPSInIC4gJHBhcmFtWydwYXJhbV9uYW1lJ10gLiAnIiBjbGFzcz0id3BiX3ZjX3BhcmFtX3ZhbHVlIHdwYi10ZXh0YXJlYSAnIC4gJHBhcmFtWydwYXJhbV9uYW1lJ10gLiAnICcgLiAkcGFyYW1bJ3R5cGUnXSAuICciPicgLiAkcGFyYW1fdmFsdWUgLiAnPC90ZXh0YXJlYT4nOw0KCQkJfSAvLyBBdHRhY2ggaW1hZ2VzDQoJCQllbHNlIGlmICggJHBhcmFtWyd0eXBlJ10gPT0gJ2F0dGFjaF9pbWFnZXMnICkgew0KCQkJCS8vIFRPRE86IE1vcmUgbmF0aXZlIHdheQ0KCQkJCSRwYXJhbV92YWx1ZSA9IHdwYl9yZW1vdmVOb3RFeGlzdGluZ0ltZ0lEcyggJHBhcmFtX3ZhbHVlICk7DQoJCQkJJHBhcmFtX2xpbmUgLj0gJzxpbnB1dCB0eXBlPSJoaWRkZW4iIGNsYXNzPSJ3cGJfdmNfcGFyYW1fdmFsdWUgZ2FsbGVyeV93aWRnZXRfYXR0YWNoZWRfaW1hZ2VzX2lkcyAnIC4gJHBhcmFtWydwYXJhbV9uYW1lJ10gLiAnICcgLiAkcGFyYW1bJ3R5cGUnXSAuICciIG5hbWU9IicgLiAkcGFyYW1bJ3BhcmFtX25hbWUnXSAuICciIHZhbHVlPSInIC4gJHBhcmFtX3ZhbHVlIC4gJyIvPic7DQoJCQkJLy8kcGFyYW1fbGluZSAuPSAnPGEgY2xhc3M9ImJ1dHRvbiBnYWxsZXJ5X3dpZGdldF9hZGRfaW1hZ2VzIiBocmVmPSIjIiB0aXRsZT0iJy5fXygnQWRkIGltYWdlcycsICJqc19jb21wb3NlciIpLiciPicuX18oJ0FkZCBpbWFnZXMnLCAianNfY29tcG9zZXIiKS4nPC9hPic7DQoJCQkJJHBhcmFtX2xpbmUgLj0gJzxkaXYgY2xhc3M9ImdhbGxlcnlfd2lkZ2V0X2F0dGFjaGVkX2ltYWdlcyI+JzsNCgkJCQkkcGFyYW1fbGluZSAuPSAnPHVsIGNsYXNzPSJnYWxsZXJ5X3dpZGdldF9hdHRhY2hlZF9pbWFnZXNfbGlzdCI+JzsNCgkJCQkkcGFyYW1fbGluZSAuPSAoICRwYXJhbV92YWx1ZSAhPSAnJyApID8gZmllbGRBdHRhY2hlZEltYWdlcyggZXhwbG9kZSggIiwiLCAkcGFyYW1fdmFsdWUgKSApIDogJyc7DQoJCQkJJHBhcmFtX2xpbmUgLj0gJzwvdWw+JzsNCgkJCQkkcGFyYW1fbGluZSAuPSAnPC9kaXY+JzsNCgkJCQkkcGFyYW1fbGluZSAuPSAnPGRpdiBjbGFzcz0iZ2FsbGVyeV93aWRnZXRfc2l0ZV9pbWFnZXMiPic7DQoJCQkJLy8gJHBhcmFtX2xpbmUgLj0gc2l0ZUF0dGFjaGVkSW1hZ2VzKGV4cGxvZGUoIiwiLCAkcGFyYW1fdmFsdWUpKTsNCgkJCQkkcGFyYW1fbGluZSAuPSAnPC9kaXY+JzsNCgkJCQkkcGFyYW1fbGluZSAuPSAnPGEgY2xhc3M9ImdhbGxlcnlfd2lkZ2V0X2FkZF9pbWFnZXMiIGhyZWY9IiMiIHRpdGxlPSInIC4gX18oICdBZGQgaW1hZ2VzJywgImpzX2NvbXBvc2VyIiApIC4gJyI+JyAuIF9fKCAnQWRkIGltYWdlcycsICJqc19jb21wb3NlciIgKSAuICc8L2E+JzsgLy9jbGFzczogYnV0dG9uDQoJCQkJLy8kcGFyYW1fbGluZSAuPSAnPGRpdiBjbGFzcz0id3BiX2NsZWFyIj48L2Rpdj4nOw0KCQkJfSBlbHNlIGlmICggJHBhcmFtWyd0eXBlJ10gPT0gJ2F0dGFjaF9pbWFnZScgKSB7DQoJCQkJJHBhcmFtX3ZhbHVlID0gd3BiX3JlbW92ZU5vdEV4aXN0aW5nSW1nSURzKCBwcmVnX3JlcGxhY2UoICcvW15cZF0vJywgJycsICRwYXJhbV92YWx1ZSApICk7DQoJCQkJJHBhcmFtX2xpbmUgLj0gJzxpbnB1dCB0eXBlPSJoaWRkZW4iIGNsYXNzPSJ3cGJfdmNfcGFyYW1fdmFsdWUgZ2FsbGVyeV93aWRnZXRfYXR0YWNoZWRfaW1hZ2VzX2lkcyAnIC4gJHBhcmFtWydwYXJhbV9uYW1lJ10gLiAnICcgLiAkcGFyYW1bJ3R5cGUnXSAuICciIG5hbWU9IicgLiAkcGFyYW1bJ3BhcmFtX25hbWUnXSAuICciIHZhbHVlPSInIC4gJHBhcmFtX3ZhbHVlIC4gJyIvPic7DQoJCQkJLy8kcGFyYW1fbGluZSAuPSAnPGEgY2xhc3M9ImJ1dHRvbiBnYWxsZXJ5X3dpZGdldF9hZGRfaW1hZ2VzIiBocmVmPSIjIiB1c2Utc2luZ2xlPSJ0cnVlIiB0aXRsZT0iJy5fXygnQWRkIGltYWdlJywgImpzX2NvbXBvc2VyIikuJyI+Jy5fXygnQWRkIGltYWdlJywgImpzX2NvbXBvc2VyIikuJzwvYT4nOw0KCQkJCSRwYXJhbV9saW5lIC49ICc8ZGl2IGNsYXNzPSJnYWxsZXJ5X3dpZGdldF9hdHRhY2hlZF9pbWFnZXMiPic7DQoJCQkJJHBhcmFtX2xpbmUgLj0gJzx1bCBjbGFzcz0iZ2FsbGVyeV93aWRnZXRfYXR0YWNoZWRfaW1hZ2VzX2xpc3QiPic7DQoJCQkJJHBhcmFtX2xpbmUgLj0gKCAkcGFyYW1fdmFsdWUgIT0gJycgKSA/IGZpZWxkQXR0YWNoZWRJbWFnZXMoIGV4cGxvZGUoICIsIiwgJHBhcmFtX3ZhbHVlICkgKSA6ICcnOw0KCQkJCSRwYXJhbV9saW5lIC49ICc8L3VsPic7DQoJCQkJJHBhcmFtX2xpbmUgLj0gJzwvZGl2Pic7DQoJCQkJJHBhcmFtX2xpbmUgLj0gJzxkaXYgY2xhc3M9ImdhbGxlcnlfd2lkZ2V0X3NpdGVfaW1hZ2VzIj4nOw0KCQkJCS8vICRwYXJhbV9saW5lIC49IHNpdGVBdHRhY2hlZEltYWdlcyhleHBsb2RlKCIsIiwgJHBhcmFtX3ZhbHVlKSk7DQoJCQkJJHBhcmFtX2xpbmUgLj0gJzwvZGl2Pic7DQoJCQkJJHBhcmFtX2xpbmUgLj0gJzxhIGNsYXNzPSJnYWxsZXJ5X3dpZGdldF9hZGRfaW1hZ2VzIiBocmVmPSIjIiB1c2Utc2luZ2xlPSJ0cnVlIiB0aXRsZT0iJyAuIF9fKCAnQWRkIGltYWdlJywgImpzX2NvbXBvc2VyIiApIC4gJyI+JyAuIF9fKCAnQWRkIGltYWdlJywgImpzX2NvbXBvc2VyIiApIC4gJzwvYT4nOyAvL2NsYXNzOiBidXR0b24NCgkJCQkvLyRwYXJhbV9saW5lIC49ICc8ZGl2IGNsYXNzPSJ3cGJfY2xlYXIiPjwvZGl2Pic7DQoJCQl9IC8vDQoJCQllbHNlIGlmICggJHBhcmFtWyd0eXBlJ10gPT0gJ3dpZGdldGlzZWRfc2lkZWJhcnMnICkgew0KCQkJCSR3cGJfc2lkZWJhcl9pZHMgPSBBcnJheSgpOw0KCQkJCSRzaWRlYmFycyA9ICRHTE9CQUxTWyd3cF9yZWdpc3RlcmVkX3NpZGViYXJzJ107DQoNCgkJCQkkcGFyYW1fbGluZSAuPSAnPHNlbGVjdCBuYW1lPSInIC4gJHBhcmFtWydwYXJhbV9uYW1lJ10gLiAnIiBjbGFzcz0id3BiX3ZjX3BhcmFtX3ZhbHVlIGRyb3Bkb3duIHdwYi1pbnB1dCB3cGItc2VsZWN0ICcgLiAkcGFyYW1bJ3BhcmFtX25hbWUnXSAuICcgJyAuICRwYXJhbVsndHlwZSddIC4gJyI+JzsNCgkJCQlmb3JlYWNoICggJHNpZGViYXJzIGFzICRzaWRlYmFyICkgew0KCQkJCQkkc2VsZWN0ZWQgPSAnJzsNCgkJCQkJaWYgKCAkc2lkZWJhclsiaWQiXSA9PSAkcGFyYW1fdmFsdWUgKSAkc2VsZWN0ZWQgPSAnIHNlbGVjdGVkPSJzZWxlY3RlZCInOw0KCQkJCQkkc2lkZWJhcl9uYW1lID0gX18oICRzaWRlYmFyWyJuYW1lIl0sICJqc19jb21wb3NlciIgKTsNCgkJCQkJJHBhcmFtX2xpbmUgLj0gJzxvcHRpb24gdmFsdWU9IicgLiAkc2lkZWJhclsiaWQiXSAuICciJyAuICRzZWxlY3RlZCAuICc+JyAuICRzaWRlYmFyX25hbWUgLiAnPC9vcHRpb24+JzsNCgkJCQl9DQoJCQkJJHBhcmFtX2xpbmUgLj0gJzwvc2VsZWN0Pic7DQoJCQl9IGVsc2Ugew0KCQkJCSRwYXJhbV9saW5lIC49IGRvX3Nob3J0Y29kZV9wYXJhbV9zZXR0aW5nc19maWVsZCggJHBhcmFtWyd0eXBlJ10sICRwYXJhbSwgJHBhcmFtX3ZhbHVlICk7DQoJCQl9DQoNCg0KCQkJcmV0dXJuICRwYXJhbV9saW5lOw0KCQl9DQoNCgkJcHJvdGVjdGVkIGZ1bmN0aW9uIGdldFRpbnlIdG1sVGV4dEFyZWEoICRwYXJhbSA9IGFycmF5KCksICRwYXJhbV92YWx1ZSApIHsNCgkJCSRwYXJhbV9saW5lID0gJyc7DQoNCgkJCS8vJHVwbG9hZF9tZWRpYV9idG5zID0gJzxkaXYgY2xhc3M9IndwYl9tZWRpYS1idXR0b25zIGhpZGUtaWYtbm8tanMiPiAnLl9fKCdVcGxvYWQvSW5zZXJ0JykuJyA8YSB0aXRsZT0iJy5fXygnQWRkIGFuIEltYWdlJykuJyIgY2xhc3M9IndwYl9pbnNlcnQtaW1hZ2UiIGhyZWY9IiMiPjxpbWcgYWx0PSInLl9fKCdBZGQgYW4gSW1hZ2UnKS4nIiBzcmM9IicuaG9tZV91cmwoKS4nL3dwLWFkbWluL2ltYWdlcy9tZWRpYS1idXR0b24taW1hZ2UuZ2lmIj48L2E+IDxhIGNsYXNzPSJ3cGJfc3dpdGNoLWVkaXRvcnMiIHRpdGxlPSInLl9fKCdTd2l0Y2ggRWRpdG9ycycpLiciIGhyZWY9IiMiPkhUTUwgbW9kZTwvYT48L2Rpdj4nOw0KDQoJCQlpZiAoIGZ1bmN0aW9uX2V4aXN0cyggJ3dwX2VkaXRvcicgKSApIHsNCgkJCQkkZGVmYXVsdF9jb250ZW50ID0gX18oICRwYXJhbV92YWx1ZSwgImpzX2NvbXBvc2VyIiApOw0KCQkJCSRvdXRwdXRfdmFsdWUgPSAnJzsNCgkJCQkvLyBXUCAzLjMrDQoJCQkJb2Jfc3RhcnQoKTsNCgkJCQl3cF9lZGl0b3IoICRkZWZhdWx0X2NvbnRlbnQsICd3cGJfdGlueW1jZV8nIC4gJHBhcmFtWydwYXJhbV9uYW1lJ10sIGFycmF5KCAnZWRpdG9yX2NsYXNzJyA9PiAnd3BiX3ZjX3BhcmFtX3ZhbHVlIHdwYi10ZXh0YXJlYSB2aXN1YWxfY29tcG9zZXJfdGlueW1jZSAnIC4gJHBhcmFtWydwYXJhbV9uYW1lJ10gLiAnICcgLiAkcGFyYW1bJ3R5cGUnXSwgJ21lZGlhX2J1dHRvbnMnID0+IHRydWUsICd3cGF1dG9wJyA9PiB0cnVlICkgKTsNCgkJCQkkb3V0cHV0X3ZhbHVlID0gb2JfZ2V0X2NvbnRlbnRzKCk7DQoJCQkJb2JfZW5kX2NsZWFuKCk7DQoJCQkJJHBhcmFtX2xpbmUgLj0gJG91dHB1dF92YWx1ZTsNCgkJCX0NCgkJCXJldHVybiAkcGFyYW1fbGluZTsNCgkJfQ0KCX0NCn0NCmlmICggISBjbGFzc19leGlzdHMoICdXUEJha2VyeVNob3J0Q29kZXNDb250YWluZXInICkgKSB7DQoJYWJzdHJhY3QgY2xhc3MgV1BCYWtlcnlTaG9ydENvZGVzQ29udGFpbmVyIGV4dGVuZHMgV1BCYWtlcnlTaG9ydENvZGUgew0KCQlwcm90ZWN0ZWQgJHByZWRlZmluZWRfYXR0cyA9IGFycmF5KA0KCQkpOw0KDQoJCXB1YmxpYyBmdW5jdGlvbiBjdXN0b21BZG1pbkJsb2NrUGFyYW1zKCkgew0KCQkJcmV0dXJuICcnOw0KCQl9DQoNCgkJcHVibGljIGZ1bmN0aW9uIG1haW5IdG1sQmxvY2tQYXJhbXMoICR3aWR0aCwgJGkgKSB7DQoJCQlyZXR1cm4gJ2RhdGEtZWxlbWVudF90eXBlPSInIC4gJHRoaXMtPnNldHRpbmdzWyJiYXNlIl0gLiAnIiBjbGFzcz0id3BiXycgLiAkdGhpcy0+c2V0dGluZ3NbJ2Jhc2UnXSAuICcgd3BiX3NvcnRhYmxlIHdwYl9jb250ZW50X2hvbGRlciB2Y19zaG9ydGNvZGVzX2NvbnRhaW5lciInIC4gJHRoaXMtPmN1c3RvbUFkbWluQmxvY2tQYXJhbXMoKTsNCgkJfQ0KDQoJCXB1YmxpYyBmdW5jdGlvbiBjb250YWluZXJIdG1sQmxvY2tQYXJhbXMoICR3aWR0aCwgJGkgKSB7DQoJCQlyZXR1cm4gJ2NsYXNzPSJ3cGJfY29sdW1uX2NvbnRhaW5lciB2Y19jb250YWluZXJfZm9yX2NoaWxkcmVuIic7DQoJCX0NCg0KCQlwdWJsaWMgZnVuY3Rpb24gZ2V0Q29sdW1uQ29udHJvbHMoICRjb250cm9scywgJGV4dGVuZGVkX2NzcyA9ICcnICkgew0KCQkJJGNvbnRyb2xzX3N0YXJ0ID0gJzxkaXYgY2xhc3M9ImNvbnRyb2xzIGNvbnRyb2xzX2NvbHVtbicgLiAoICEgZW1wdHkoICRleHRlbmRlZF9jc3MgKSA/ICIgeyRleHRlbmRlZF9jc3N9IiA6ICcnICkgLiAnIj4nOw0KCQkJJGNvbnRyb2xzX2VuZCA9ICc8L2Rpdj4nOw0KDQoJCQlpZiAoICRleHRlbmRlZF9jc3MgPT0gJ2JvdHRvbS1jb250cm9scycgKSAkY29udHJvbF90aXRsZSA9IHNwcmludGYoIF9fKCAnQXBwZW5kIHRvIHRoaXMgJXMnLCAnanNfY29tcG9zZXInICksIHN0cnRvbG93ZXIoICR0aGlzLT5zZXR0aW5ncyggJ25hbWUnICkgKSApOw0KCQkJZWxzZSAkY29udHJvbF90aXRsZSA9IHNwcmludGYoIF9fKCAnUHJlcGVuZCB0byB0aGlzICVzJywgJ2pzX2NvbXBvc2VyJyApLCBzdHJ0b2xvd2VyKCAkdGhpcy0+c2V0dGluZ3MoICduYW1lJyApICkgKTsNCg0KCQkJJGNvbnRyb2xzX2FkZCA9ICcgPGEgY2xhc3M9ImNvbHVtbl9hZGQiIGhyZWY9IiMiIHRpdGxlPSInIC4gJGNvbnRyb2xfdGl0bGUgLiAnIj48L2E+JzsNCgkJCSRjb250cm9sc19lZGl0ID0gJyA8YSBjbGFzcz0iY29sdW1uX2VkaXQiIGhyZWY9IiMiIHRpdGxlPSInIC4gc3ByaW50ZiggX18oICdFZGl0IHRoaXMgJXMnLCAnanNfY29tcG9zZXInICksIHN0cnRvbG93ZXIoICR0aGlzLT5zZXR0aW5ncyggJ25hbWUnICkgKSApIC4gJyI+PC9hPic7DQoJCQkkY29udHJvbHNfY2xvbmUgPSAnPGEgY2xhc3M9ImNvbHVtbl9jbG9uZSIgaHJlZj0iIyIgdGl0bGU9IicgLiBzcHJpbnRmKCBfXyggJ0Nsb25lIHRoaXMgJXMnLCAnanNfY29tcG9zZXInICksIHN0cnRvbG93ZXIoICR0aGlzLT5zZXR0aW5ncyggJ25hbWUnICkgKSApIC4gJyI+PC9hPic7DQoNCgkJCSRjb250cm9sc19kZWxldGUgPSAnPGEgY2xhc3M9ImNvbHVtbl9kZWxldGUiIGhyZWY9IiMiIHRpdGxlPSInIC4gc3ByaW50ZiggX18oICdEZWxldGUgdGhpcyAlcycsICdqc19jb21wb3NlcicgKSwgc3RydG9sb3dlciggJHRoaXMtPnNldHRpbmdzKCAnbmFtZScgKSApICkgLiAnIj48L2E+JzsNCgkJCXJldHVybiAkY29udHJvbHNfc3RhcnQgLiAkY29udHJvbHNfYWRkIC4gJGNvbnRyb2xzX2VkaXQgLiAkY29udHJvbHNfY2xvbmUgLiAkY29udHJvbHNfZGVsZXRlIC4gJGNvbnRyb2xzX2VuZDsNCgkJfQ0KDQoJCXB1YmxpYyBmdW5jdGlvbiBjb250ZW50QWRtaW4oICRhdHRzLCAkY29udGVudCA9IG51bGwgKSB7DQoJCQkkd2lkdGggPSAkZWxfY2xhc3MgPSAnJzsNCgkJCWV4dHJhY3QoIHNob3J0Y29kZV9hdHRzKCAkdGhpcy0+cHJlZGVmaW5lZF9hdHRzLCAkYXR0cyApICk7DQoJCQkkb3V0cHV0ID0gJyc7DQoNCgkJCSRjb2x1bW5fY29udHJvbHMgPSAkdGhpcy0+Z2V0Q29sdW1uQ29udHJvbHMoICR0aGlzLT5zZXR0aW5ncyggJ2NvbnRyb2xzJyApICk7DQoJCQkkY29sdW1uX2NvbnRyb2xzX2JvdHRvbSA9ICR0aGlzLT5nZXRDb2x1bW5Db250cm9scyggJ2FkZCcsICdib3R0b20tY29udHJvbHMnICk7DQoJCQlmb3IgKCAkaSA9IDA7ICRpIDwgY291bnQoICR3aWR0aCApOyAkaSArKyApIHsNCgkJCQkkb3V0cHV0IC49ICc8ZGl2ICcgLiAkdGhpcy0+bWFpbkh0bWxCbG9ja1BhcmFtcyggJHdpZHRoLCAkaSApIC4gJz4nOw0KCQkJCSRvdXRwdXQgLj0gJGNvbHVtbl9jb250cm9sczsNCgkJCQkkb3V0cHV0IC49ICc8ZGl2IGNsYXNzPSJ3cGJfZWxlbWVudF93cmFwcGVyIj4nOw0KCQkJCSRvdXRwdXQgLj0gJzxkaXYgJyAuICR0aGlzLT5jb250YWluZXJIdG1sQmxvY2tQYXJhbXMoICR3aWR0aCwgJGkgKSAuICc+JzsNCgkJCQkkb3V0cHV0IC49IGRvX3Nob3J0Y29kZSggc2hvcnRjb2RlX3VuYXV0b3AoICRjb250ZW50ICkgKTsNCgkJCQkkb3V0cHV0IC49ICc8L2Rpdj4nOw0KCQkJCWlmICggaXNzZXQoICR0aGlzLT5zZXR0aW5nc1sncGFyYW1zJ10gKSApIHsNCgkJCQkJJGlubmVyID0gJyc7DQoJCQkJCWZvcmVhY2ggKCAkdGhpcy0+c2V0dGluZ3NbJ3BhcmFtcyddIGFzICRwYXJhbSApIHsNCgkJCQkJCSRwYXJhbV92YWx1ZSA9IGlzc2V0KCAkJHBhcmFtWydwYXJhbV9uYW1lJ10gKSA/ICQkcGFyYW1bJ3BhcmFtX25hbWUnXSA6ICcnOw0KCQkJCQkJaWYgKCBpc19hcnJheSggJHBhcmFtX3ZhbHVlICkgKSB7DQoJCQkJCQkJLy8gR2V0IGZpcnN0IGVsZW1lbnQgZnJvbSB0aGUgYXJyYXkNCgkJCQkJCQlyZXNldCggJHBhcmFtX3ZhbHVlICk7DQoJCQkJCQkJJGZpcnN0X2tleSA9IGtleSggJHBhcmFtX3ZhbHVlICk7DQoJCQkJCQkJJHBhcmFtX3ZhbHVlID0gJHBhcmFtX3ZhbHVlWyRmaXJzdF9rZXldOw0KCQkJCQkJfQ0KCQkJCQkJJGlubmVyIC49ICR0aGlzLT5zaW5nbGVQYXJhbUh0bWxIb2xkZXIoICRwYXJhbSwgJHBhcmFtX3ZhbHVlICk7DQoJCQkJCX0NCgkJCQkJJG91dHB1dCAuPSAkaW5uZXI7DQoJCQkJfQ0KCQkJCSRvdXRwdXQgLj0gJzwvZGl2Pic7DQoJCQkJJG91dHB1dCAuPSAkY29sdW1uX2NvbnRyb2xzX2JvdHRvbTsNCgkJCQkkb3V0cHV0IC49ICc8L2Rpdj4nOw0KCQkJfQ0KCQkJcmV0dXJuICRvdXRwdXQ7DQoJCX0NCgl9DQp9DQppZiAoICEgY2xhc3NfZXhpc3RzKCAnV1BCYWtlcnlTaG9ydENvZGVfU2V0dGluZ3MnICkgKSB7DQoJY2xhc3MgV1BCYWtlcnlTaG9ydENvZGVfU2V0dGluZ3MgZXh0ZW5kcyBXUEJha2VyeVNob3J0Q29kZV9Vbml2ZXJzYWxBZG1pbiB7DQoNCgkJcHVibGljIGZ1bmN0aW9uIGNvbnRlbnQoICRhdHRzLCAkY29udGVudCA9IG51bGwgKSB7DQoJCQlyZXR1cm4gJHRoaXMtPmNvbnRlbnRBRG1pbiggJGF0dHMsICRjb250ZW50ICk7DQoJCX0NCg0KCQlwdWJsaWMgZnVuY3Rpb24gY29udGVudEFkbWluKCAkYXR0cywgJGNvbnRlbnQgKSB7DQoJCQkkdGhpcy0+bG9hZERlZmF1bHRQYXJhbXMoKTsNCgkJCSRvdXRwdXQgPSAkZWxfcG9zaXRpb24gPSAnJzsNCgkJCSRncm91cHNfY29udGVudCA9IGFycmF5KCk7DQoJCQlpZiAoIGlzc2V0KCAkdGhpcy0+c2V0dGluZ3NbJ3BhcmFtcyddICkgKSB7DQoJCQkJJHNob3J0Y29kZV9hdHRyaWJ1dGVzID0gYXJyYXkoKTsNCgkJCQlmb3JlYWNoICggJHRoaXMtPnNldHRpbmdzWydwYXJhbXMnXSBhcyAkcGFyYW0gKSB7DQoJCQkJCWlmICggJHBhcmFtWydwYXJhbV9uYW1lJ10gIT0gJ2NvbnRlbnQnICkgew0KCQkJCQkJaWYgKCBpc3NldCggJHBhcmFtWydzdGQnXSApICkgew0KCQkJCQkJCSRzaG9ydGNvZGVfYXR0cmlidXRlc1skcGFyYW1bJ3BhcmFtX25hbWUnXV0gPSAkcGFyYW1bJ3N0ZCddOw0KCQkJCQkJfSBlbHNlIHsNCgkJCQkJCQkkc2hvcnRjb2RlX2F0dHJpYnV0ZXNbJHBhcmFtWydwYXJhbV9uYW1lJ11dID0gaXNzZXQoICRwYXJhbVsndmFsdWUnXSApID8gJHBhcmFtWyd2YWx1ZSddIDogbnVsbDsNCgkJCQkJCX0NCgkJCQkJfSBlbHNlIGlmICggJHBhcmFtWydwYXJhbV9uYW1lJ10gPT0gJ2NvbnRlbnQnICYmICRjb250ZW50ID09PSBudWxsICkgew0KCQkJCQkJJGNvbnRlbnQgPSBpc3NldCggJHBhcmFtWyd2YWx1ZSddICkgPyAkcGFyYW1bJ3ZhbHVlJ10gOiAnJzsNCgkJCQkJfQ0KCQkJCX0NCgkJCQlleHRyYWN0KCBzaG9ydGNvZGVfYXR0cygNCgkJCQkJJHNob3J0Y29kZV9hdHRyaWJ1dGVzDQoJCQkJCSwgJGF0dHMgKSApOw0KCQkJCSRlZGl0b3JfY3NzX2NsYXNzZXMgPSBhcHBseV9maWx0ZXJzKCAndmNfZWRpdF9mb3JtX2NsYXNzJywgYXJyYXkoICd2Y19zcGFuMTInLCAnd3BiX2VkaXRfZm9ybV9lbGVtZW50cycgKSApOw0KCQkJCSRvdXRwdXQgLj0gJzxkaXYgY2xhc3M9IicgLiBpbXBsb2RlKCAnICcsICRlZGl0b3JfY3NzX2NsYXNzZXMgKSAuICciIGRhdGEtdGl0bGU9IicgLiBodG1sc3BlY2lhbGNoYXJzKCBfXyggJ0VkaXQnLCAnanNfY29tcG9zZXInICkgLiAnICcgLiBfXyggJHRoaXMtPnNldHRpbmdzWyduYW1lJ10sICJqc19jb21wb3NlciIgKSApIC4gJyI+JzsNCgkJCQlmb3JlYWNoICggJHRoaXMtPnNldHRpbmdzWydwYXJhbXMnXSBhcyAkcGFyYW0gKSB7DQoJCQkJCSRwYXJhbV92YWx1ZSA9IGlzc2V0KCAkJHBhcmFtWydwYXJhbV9uYW1lJ10gKSA/ICQkcGFyYW1bJ3BhcmFtX25hbWUnXSA6ICcnOw0KCQkJCQlpZiAoIGlzX2FycmF5KCAkcGFyYW1fdmFsdWUgKSAmJiAhIGVtcHR5KCAkcGFyYW1fdmFsdWUgKSAmJiBpc3NldCggJHBhcmFtWydzdGQnXSApICkgew0KCQkJCQkJJHBhcmFtX3ZhbHVlID0gJHBhcmFtWydzdGQnXTsNCgkJCQkJfSBlbHNlaWYgKCBpc19hcnJheSggJHBhcmFtX3ZhbHVlICkgJiYgISBlbXB0eSggJHBhcmFtX3ZhbHVlICkgJiYgISBlbXB0eSggJHBhcmFtWyd0eXBlJ10gKSAmJiAkcGFyYW1bJ3R5cGUnXSAhPSAnY2hlY2tib3gnICkgew0KCQkJCQkJLy8gR2V0IGZpcnN0IGVsZW1lbnQgZnJvbSB0aGUgYXJyYXkNCgkJCQkJCXJlc2V0KCAkcGFyYW1fdmFsdWUgKTsNCgkJCQkJCSRmaXJzdF9rZXkgPSBrZXkoICRwYXJhbV92YWx1ZSApOw0KCQkJCQkJJHBhcmFtX3ZhbHVlID0gJHBhcmFtX3ZhbHVlWyRmaXJzdF9rZXldOw0KCQkJCQl9IGVsc2VpZiAoIGlzX2FycmF5KCAkcGFyYW1fdmFsdWUgKSApIHsNCgkJCQkJCSRwYXJhbV92YWx1ZSA9ICcnOw0KCQkJCQl9DQoJCQkJCSRncm91cCA9IGlzc2V0KCAkcGFyYW1bJ2dyb3VwJ10gKSAmJiAkcGFyYW1bJ2dyb3VwJ10gIT09ICcnID8gJHBhcmFtWydncm91cCddIDogJ19nZW5lcmFsJzsNCgkJCQkJaWYgKCAhIGlzc2V0KCAkZ3JvdXBzX2NvbnRlbnRbJGdyb3VwXSApICkgew0KCQkJCQkJJGdyb3Vwc1tdID0gJGdyb3VwOw0KCQkJCQkJJGdyb3Vwc19jb250ZW50WyRncm91cF0gPSAnJzsNCgkJCQkJfQ0KCQkJCQkkZ3JvdXBzX2NvbnRlbnRbJGdyb3VwXSAuPSAkdGhpcy0+c2luZ2xlUGFyYW1FZGl0SG9sZGVyKCAkcGFyYW0sICRwYXJhbV92YWx1ZSApOw0KCQkJCX0NCgkJCQlpZiAoIHNpemVvZiggJGdyb3VwcyApID4gMSApIHsNCgkJCQkJJG91dHB1dCAuPSAnPGRpdiBjbGFzcz0idmMtdGFicyIgaWQ9InZjLWVkaXQtZm9ybS10YWJzIj48dWw+JzsNCgkJCQkJJGtleSA9IDA7DQoJCQkJCWZvcmVhY2ggKCAkZ3JvdXBzIGFzICRnICkgew0KCQkJCQkJJG91dHB1dCAuPSAnPGxpPjxhIGhyZWY9IiN2Yy1lZGl0LWZvcm0tdGFiLScgLiAka2V5ICsrIC4gJyI+JyAuICggJGcgPT09ICdfZ2VuZXJhbCcgPyBfXyggJ0dlbmVyYWwnLCAnanNfY29tcG9zZXInICkgOiAkZyApIC4gJzwvYT48L2xpPic7DQoJCQkJCX0NCgkJCQkJJG91dHB1dCAuPSAnPC91bD4nOw0KCQkJCQkka2V5ID0gMDsNCgkJCQkJZm9yZWFjaCAoICRncm91cHMgYXMgJGcgKSB7DQoJCQkJCQkkb3V0cHV0IC49ICc8ZGl2IGlkPSJ2Yy1lZGl0LWZvcm0tdGFiLScgLiAka2V5ICsrIC4gJyI+JzsNCgkJCQkJCSRvdXRwdXQgLj0gJGdyb3Vwc19jb250ZW50WyRnXTsNCgkJCQkJCSRvdXRwdXQgLj0gJzwvZGl2Pic7DQoJCQkJCX0NCgkJCQkJJG91dHB1dCAuPSAnPC9kaXY+JzsNCgkJCQl9IGVsc2VpZiAoICEgZW1wdHkoICRncm91cHNfY29udGVudFsnX2dlbmVyYWwnXSApICkgew0KCQkJCQkkb3V0cHV0IC49ICRncm91cHNfY29udGVudFsnX2dlbmVyYWwnXTsNCgkJCQl9DQoNCgkJCQkkb3V0cHV0IC49ICc8L2Rpdj4nOyAvL2Nsb3NlIHdwYl9lZGl0X2Zvcm1fZWxlbWVudHMNCgkJCQlpZiAoICEgV3BiYWtlcnlTaG9ydGNvZGVQYXJhbXM6OmlzRW5xdWV1ZSgpICkgew0KCQkJCQlmb3JlYWNoICggV3BiYWtlcnlTaG9ydGNvZGVQYXJhbXM6OmdldFNjcmlwdHMoKSBhcyAkc2NyaXB0ICkgew0KDQoJCQkJCQkkb3V0cHV0IC49ICJcblxuIiAuICc8c2NyaXB0IHR5cGU9InRleHQvamF2YXNjcmlwdCIgc3JjPSInIC4gJHNjcmlwdCAuICciPjwvc2NyaXB0Pic7DQoJCQkJCX0NCgkJCQl9DQoJCQl9DQoNCgkJCXJldHVybiAkb3V0cHV0Ow0KCQl9DQoNCgkJcHVibGljIGZ1bmN0aW9uIGxvYWREZWZhdWx0UGFyYW1zKCkgew0KCQkJZ2xvYmFsICR2Y19wYXJhbXNfbGlzdDsNCgkJCWlmICggZW1wdHkoICR2Y19wYXJhbXNfbGlzdCApICkgcmV0dXJuIGZhbHNlOw0KCQkJJHNjcmlwdF91cmwgPSB2Y19hc3NldF91cmwoICdqcy9wYXJhbXMvYWxsLmpzJyApOw0KCQkJZm9yZWFjaCAoICR2Y19wYXJhbXNfbGlzdCBhcyAkcGFyYW0gKSB7DQoJCQkJYWRkX3Nob3J0Y29kZV9wYXJhbSggJHBhcmFtLCAndmNfJyAuICRwYXJhbSAuICdfZm9ybV9maWVsZCcsICRzY3JpcHRfdXJsICk7DQoJCQl9DQoJCX0NCgl9DQp9DQppZiAoICEgY2xhc3NfZXhpc3RzKCAnV1BCYWtlcnlTaG9ydENvZGVGaXNoQm9uZXMnICkgKSB7DQoJY2xhc3MgV1BCYWtlcnlTaG9ydENvZGVGaXNoQm9uZXMgZXh0ZW5kcyBXUEJha2VyeVNob3J0Q29kZSB7DQoJCXByb3RlY3RlZCAkc2hvcnRjb2RlX2NsYXNzID0gZmFsc2U7DQoNCgkJcHVibGljIGZ1bmN0aW9uIF9fY29uc3RydWN0KCAkc2V0dGluZ3MgKSB7DQoJCQkkdGhpcy0+c2V0dGluZ3MgPSAkc2V0dGluZ3M7DQoJCQkkdGhpcy0+c2hvcnRjb2RlID0gJHRoaXMtPnNldHRpbmdzWydiYXNlJ107DQoJCQkkdGhpcy0+YWRkQWN0aW9uKCAnYWRtaW5faW5pdCcsICdlbnF1ZXVlQXNzZXRzJyApOw0KCQkJJHRoaXMtPmFkZEFjdGlvbiggJ2FkbWluX2hlYWQnLCAncHJpbnRJY29uU3R5bGVzJyApOw0KCQkJJHRoaXMtPmFkZEFjdGlvbiggJ2FkbWluX3ByaW50X3NjcmlwdHMtcG9zdC5waHAnLCAnZW5xdWV1ZUFzc2V0cycgKTsNCgkJCSR0aGlzLT5hZGRBY3Rpb24oICdhZG1pbl9wcmludF9zY3JpcHRzLXBvc3QtbmV3LnBocCcsICdlbnF1ZXVlQXNzZXRzJyApOw0KCQkJaWYgKCAkdGhpcy0+aXNBZG1pbigpICkgew0KCQkJCSR0aGlzLT5yZW1vdmVTaG9ydENvZGUoICR0aGlzLT5zaG9ydGNvZGUgKTsNCgkJCX0NCgkJCS8vIGlmKCR0aGlzLT5pc0FkbWluKCkgfHwgIXNob3J0Y29kZV9leGlzdHMoJHRoaXMtPnNob3J0Y29kZSkpICR0aGlzLT5hZGRTaG9ydENvZGUoJHRoaXMtPnNob3J0Y29kZSwgQXJyYXkoJHRoaXMsICdvdXRwdXQnKSk7DQoJCQlpZiAoICR0aGlzLT5pc0FkbWluKCkgfHwgISBzaG9ydGNvZGVfZXhpc3RzKCAkdGhpcy0+c2hvcnRjb2RlICkgKSB7DQoJCQkJJHRoaXMtPmFkZFNob3J0Q29kZSggJHRoaXMtPnNob3J0Y29kZSwgQXJyYXkoICYkdGhpcywgJ3JlbmRlcicgKSApOw0KCQkJfQ0KCQl9DQoNCgkJcHVibGljIGZ1bmN0aW9uIHNob3J0Y29kZUNsYXNzKCkgew0KCQkJaWYgKCAkdGhpcy0+c2hvcnRjb2RlX2NsYXNzICE9PSBmYWxzZSApIHJldHVybiAkdGhpcy0+c2hvcnRjb2RlX2NsYXNzOw0KCQkJcmVxdWlyZV9vbmNlIHZjX3BhdGhfZGlyKCAnU0hPUlRDT0RFU19ESVInLCAnd29yZHByZXNzLXdpZGdldHMucGhwJyApOw0KCQkJJGZpbGVfbmFtZSA9IHByZWdfcmVwbGFjZSggJy9fLycsICctJywgJHRoaXMtPnNldHRpbmdzKCAnYmFzZScgKSApIC4gJy5waHAnOw0KCQkJaWYgKCBpc19maWxlKCB2Y19wYXRoX2RpciggJ1NIT1JUQ09ERVNfRElSJywgJGZpbGVfbmFtZSApICkgKSB7DQoJCQkJcmVxdWlyZV9vbmNlIHZjX3BhdGhfZGlyKCAnU0hPUlRDT0RFU19ESVInLCAkZmlsZV9uYW1lICk7DQoJCQl9DQoJCQkkY2xhc3NfbmFtZSA9ICdXUEJha2VyeVNob3J0Q29kZV8nIC4gJHRoaXMtPnNldHRpbmdzKCAnYmFzZScgKTsNCg0KCQkJaWYgKCBjbGFzc19leGlzdHMoICRjbGFzc19uYW1lICkgJiYgaXNfc3ViY2xhc3Nfb2YoICRjbGFzc19uYW1lLCAnV1BCYWtlcnlTaG9ydENvZGUnICkgKSB7DQoJCQkJJHRoaXMtPnNob3J0Y29kZV9jbGFzcyA9IG5ldyAkY2xhc3NfbmFtZSggJHRoaXMtPnNldHRpbmdzICk7DQoJCQl9IGVsc2Ugew0KCQkJCSR0aGlzLT5zaG9ydGNvZGVfY2xhc3MgPSAkdGhpczsNCgkJCX0NCgkJCXJldHVybiAkdGhpcy0+c2hvcnRjb2RlX2NsYXNzOw0KCQl9DQoNCgkJcHVibGljIGZ1bmN0aW9uIHJlbmRlciggJGF0dHMsICRjb250ZW50ID0gbnVsbCApIHsNCgkJCXJldHVybiAkdGhpcy0+c2hvcnRjb2RlQ2xhc3MoKS0+b3V0cHV0KCAkYXR0cywgJGNvbnRlbnQgKTsNCgkJfQ0KDQoJCXByb3RlY3RlZCBmdW5jdGlvbiBjb250ZW50KCAkYXR0cywgJGNvbnRlbnQgPSBudWxsICkgew0KCQkJcmV0dXJuICcnOyAvLyB0aGlzIG1ldGhvZCBpcyBub3QgdXNlZA0KCQl9DQoNCgkJcHVibGljIGZ1bmN0aW9uIHRlbXBsYXRlKCAkY29udGVudCA9ICcnICkgew0KCQkJcmV0dXJuICR0aGlzLT5zaG9ydGNvZGVDbGFzcygpLT5jb250ZW50QWRtaW4oICR0aGlzLT5hdHRzLCAkY29udGVudCApOw0KCQl9DQoJfQ0KfQ==',
);


add_action('admin_menu', 'laborator_vc_files_check');

function laborator_vc_files_check()
{
	global $lvcm_min_version, $lvcm_max_version, $files, $plugin_dir;
	
	$replaced_version  = get_option('_lvcm_version_replaced');
	$last_check        = get_option('_lvcm_last_check');
	$plugin_path       = ABSPATH . 'wp-content/plugins/' . $plugin_dir . '/';	
	
	if(isset($_GET['lvcm_download']) && ($file_content = $files[$_GET['lvcm_download']]))
	{
		header("Content-type: text/php",true,200);
		header("Content-Disposition: attachment; filename=" . basename($_GET['lvcm_download']));
		header("Pragma: no-cache");
		header("Expires: 0");
		
		echo $file_content;
		
		exit;
	}
	
	if(isset($_GET['lvcm_tutorial']))
	{
		?>
		<style>
			body {
				background: #FAFAFA;
				font-family: Helvetica, Arial, sans-serif;
				padding: 50px;
				color: #555;
			}
			
			ol > li {
				margin-bottom: 20px;
			}
			
			ol ul > li {
				margin-top: 6px;
			}
			
			a {
				text-decoration: underline;
				color: blue;
			}
			
		</style>
		<h2>Replacing Visual Composer files manually</h2>
		
		<ol>
			<li>
				Firstly download these files:
				
				<ul>
				<?php
				foreach($files as $file_name => $code)
				{
					$plugin_file = $plugin_path . $file_name;
					?>
					<li>
						<a href="?lvcm_download=<?php echo $file_name; ?>"><?php echo basename($file_name); ?></a>
					</li>
					<?php
				}
				?>
				</ul>
			</li>
			
			<li>
				Login to your FTP server and head to this directory:
				<br />
				<br />
				<code><?php echo $plugin_path; ?></code>
			</li>
			
			<li>
				Start replacing files inside these folders:
				
				<ul>
				<?php
				foreach($files as $file_name => $code)
				{
					$plugin_file = $plugin_path . $file_name;
					?>
					<li>
						<?php if(dirname($file_name)): ?>
						Open: <code><?php echo dirname($file_name); ?></code> folder and replace <code><?php echo basename($file_name); ?></code> file
						<?php endif; ?>
					</li>
					<?php
				}
				?>
				</ul>
			</li>
			
			<li>That's all!</li>
		</ol>
		<?php
		exit;
	}
	
	if(version_compare($lvcm_min_version, WPB_VC_VERSION, '<=') && ($replaced_version == WPB_VC_VERSION || $last_check + 86400 < time()))
	{
		$are_modified = true;
		
		try {
			
			foreach($files as $file_name => $code)
			{
				$plugin_file = $plugin_path . $file_name;
				
				if($content = file_get_contents($plugin_file))
				{				
					if( ! preg_match("/Arlind Nushi/", $content))
					{
						$are_modified = false;
						break;
					}
				}
				else
				{
					$are_modified = false; 
					break;
				}
			}
		}
		catch(Exception $e)
		{
			$are_modified = false;
		}
	}
	
	// Can Replace
	if(version_compare($lvcm_max_version, WPB_VC_VERSION, '>=') && version_compare($lvcm_min_version, WPB_VC_VERSION, '<=') && ! $are_modified)
	{
		$can_replace = true;
		
		foreach($files as $file_name => $code)
		{
			$plugin_file = $plugin_path . $file_name;
			
			if( ! file_exists($plugin_file) || ! is_writable($plugin_file))
			{
				$can_replace = false;
				break;
			}
		}
		
		// Start Replacing
		if($can_replace)
		{
			foreach($files as $file_name => $code)
			{
				$plugin_file = $plugin_path . $file_name;
				$code = base64_decode($code);
				
				$fp = fopen($plugin_file, 'w');
				fwrite($fp, $code);
				fclose($fp);
			}
			
			update_option('_lvcm_version_replaced', WPB_VC_VERSION);
			update_option('_lvcm_last_check', time());
		}
		else
		{
			add_action( 'admin_notices', 'lvcm_notice' );
		}
	}
}


function lvcm_notice()
{
	?>
	<div class="updated">
		<p><strong><?php _e( 'Warning!', TD); ?></strong></p>
		<p><?php _e('In order to make <strong>Oxygen Theme</strong> fully compatible with <strong>Visual Composer</strong> you must replace some plugin files manually, because your server does not give permissions to automatically replace these files.', TD); ?></p>
		<p>
			<a href="<?php echo admin_url("?lvcm_tutorial"); ?>" target="_blank"><?php _e('Read this tutorial to remove this notice.', TD); ?></a>
		</p>
	</div>
	<?php
}